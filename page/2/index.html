<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/2.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/1.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"yoursite.com","root":"/","scheme":"Gemini","version":"7.7.2","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="Love is love">
<meta property="og:type" content="website">
<meta property="og:title" content="é™ªä½ åº¦è¿‡æ¼«é•¿å²æœˆ">
<meta property="og:url" content="http://yoursite.com/page/2/index.html">
<meta property="og:site_name" content="é™ªä½ åº¦è¿‡æ¼«é•¿å²æœˆ">
<meta property="og:description" content="Love is love">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="Anderson Wu">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://yoursite.com/page/2/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>é™ªä½ åº¦è¿‡æ¼«é•¿å²æœˆ</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="åˆ‡æ¢å¯¼èˆªæ ">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">é™ªä½ åº¦è¿‡æ¼«é•¿å²æœˆ</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">To be yourself</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>é¦–é¡µ</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-fw fa-user"></i>å…³äº</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i>æ ‡ç­¾</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i>åˆ†ç±»</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>å½’æ¡£</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index">
            

  <div class="posts-expand">
        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/10/13/SpringBoot-Token/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/self.png">
      <meta itemprop="name" content="Anderson Wu">
      <meta itemprop="description" content="Love is love">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="é™ªä½ åº¦è¿‡æ¼«é•¿å²æœˆ">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/10/13/SpringBoot-Token/" class="post-title-link" itemprop="url">SpringBootå®ç°åŸºäºTokençš„ç”¨æˆ·èº«ä»½éªŒè¯</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2019-10-13 20:02:19" itemprop="dateCreated datePublished" datetime="2019-10-13T20:02:19+08:00">2019-10-13</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2020-03-28 17:04:52" itemprop="dateModified" datetime="2020-03-28T17:04:52+08:00">2020-03-28</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/SpringBoot/" itemprop="url" rel="index"><span itemprop="name">SpringBoot</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h5 id="1-æœ¬æ–‡æ¶‰åŠåˆ°çš„çŸ¥è¯†ï¼š"><a href="#1-æœ¬æ–‡æ¶‰åŠåˆ°çš„çŸ¥è¯†ï¼š" class="headerlink" title="1.æœ¬æ–‡æ¶‰åŠåˆ°çš„çŸ¥è¯†ï¼š"></a>1.æœ¬æ–‡æ¶‰åŠåˆ°çš„çŸ¥è¯†ï¼š</h5><ul>
<li>Jwt</li>
<li>Tokenï¼Œsessionå’ŒcookieåŒºåˆ«</li>
</ul>
<h5 id="2-æ— çŠ¶æ€HTTPåè®®"><a href="#2-æ— çŠ¶æ€HTTPåè®®" class="headerlink" title="2.æ— çŠ¶æ€HTTPåè®®"></a>2.æ— çŠ¶æ€HTTPåè®®</h5><p>â€‹        ç”±äºHTTPæ˜¯ä¸€ç§æ²¡æœ‰çŠ¶æ€çš„é€šä¿¡åè®®ï¼ŒæœåŠ¡å™¨æ— æ³•è®°å½•å®¢æˆ·ç«¯çš„ç™»å½•çŠ¶æ€ä¿¡æ¯ï¼Œå½“å®¢æˆ·ç«¯é‡æ–°ç™»å½•æœåŠ¡å™¨éœ€è¦å†ä¸€æ¬¡è¿›è¡Œèº«ä»½è®¤è¯ï¼Œè¿™æ ·å¸¦æ¥ä¸å¥½çš„ç”¨æˆ·ä½“éªŒã€‚</p>
<p>â€‹        ç”¨æˆ·çš„ç™»å½•çŠ¶æ€ä¿¡æ¯å¯ä»¥ä¿å­˜åœ¨æœåŠ¡å™¨æˆ–å®¢æˆ·ç«¯ï¼Œ</p>
<h5 id="3-Tokenï¼Ÿä¸ºä»€ä¹ˆéœ€è¦Tokenï¼Ÿ"><a href="#3-Tokenï¼Ÿä¸ºä»€ä¹ˆéœ€è¦Tokenï¼Ÿ" class="headerlink" title="3.Tokenï¼Ÿä¸ºä»€ä¹ˆéœ€è¦Tokenï¼Ÿ"></a>3.Tokenï¼Ÿä¸ºä»€ä¹ˆéœ€è¦Tokenï¼Ÿ</h5><p>å¯ä»¥å‚è€ƒ<a href="https://andersonblog.github.io/2019/09/27/æµ…æcookie-session-token/" target="_blank" rel="noopener">cookie, sessionå’ŒtokenåŒºåˆ«</a>ï¼Œä»¥åŠä¸ºä»€ä¹ˆä½¿ç”¨tokenã€‚</p>
<h5 id="4-JWT"><a href="#4-JWT" class="headerlink" title="4. JWT"></a>4. JWT</h5><p>â€‹       <strong>Json web token (JWT)</strong>, æ˜¯ä¸ºäº†åœ¨ç½‘ç»œåº”ç”¨ç¯å¢ƒé—´ä¼ é€’å£°æ˜è€Œæ‰§è¡Œçš„ä¸€ç§åŸºäº<code>JSON</code>çš„å¼€æ”¾æ ‡å‡†ï¼ˆ(RFC 7519).<strong>å®šä¹‰äº†ä¸€ç§ç®€æ´çš„ï¼Œè‡ªåŒ…å«çš„æ–¹æ³•ç”¨äºé€šä¿¡åŒæ–¹ä¹‹é—´ä»¥JSONå¯¹è±¡çš„å½¢å¼å®‰å…¨çš„ä¼ é€’ä¿¡æ¯ã€‚</strong>å› ä¸ºæ•°å­—ç­¾åçš„å­˜åœ¨ï¼Œè¿™äº›ä¿¡æ¯æ˜¯å¯ä¿¡çš„ï¼Œ<strong>JWTå¯ä»¥ä½¿ç”¨HMACç®—æ³•æˆ–è€…æ˜¯RSAçš„å…¬ç§ç§˜é’¥å¯¹è¿›è¡Œç­¾åã€‚</strong></p>
<p>JWTè¯·æ±‚æµç¨‹ï¼š</p>
<p><img src="/2019/10/13/SpringBoot-Token/jwt.png" alt></p>
<ol>
<li>ç”¨æˆ·ä½¿ç”¨è´¦å·å’Œé¢å‘å‡ºpostè¯·æ±‚ï¼›</li>
<li>æœåŠ¡å™¨ä½¿ç”¨ç§é’¥åˆ›å»ºä¸€ä¸ªjwtï¼›</li>
<li>æœåŠ¡å™¨è¿”å›è¿™ä¸ªjwtç»™æµè§ˆå™¨ï¼›</li>
<li>æµè§ˆå™¨å°†è¯¥jwtä¸²åœ¨è¯·æ±‚å¤´ä¸­åƒæœåŠ¡å™¨å‘é€è¯·æ±‚ï¼›</li>
<li>æœåŠ¡å™¨éªŒè¯è¯¥jwtï¼›</li>
<li>è¿”å›å“åº”çš„èµ„æºç»™æµè§ˆå™¨ã€‚</li>
</ol>
<p><strong>JWTçš„ä¸»è¦åº”ç”¨åœºæ™¯</strong></p>
<p>â€‹         èº«ä»½è®¤è¯åœ¨è¿™ç§åœºæ™¯ä¸‹ï¼Œä¸€æ—¦ç”¨æˆ·å®Œæˆäº†ç™»é™†ï¼Œåœ¨æ¥ä¸‹æ¥çš„æ¯ä¸ªè¯·æ±‚ä¸­åŒ…å«JWTï¼Œ<strong>å¯ä»¥ç”¨æ¥éªŒè¯ç”¨æˆ·èº«ä»½ä»¥åŠå¯¹è·¯ç”±ï¼ŒæœåŠ¡å’Œèµ„æºçš„è®¿é—®æƒé™è¿›è¡ŒéªŒè¯ã€‚</strong>ç”±äºå®ƒçš„å¼€é”€éå¸¸å°ï¼Œå¯ä»¥è½»æ¾çš„åœ¨ä¸åŒåŸŸåçš„ç³»ç»Ÿä¸­ä¼ é€’ï¼Œæ‰€æœ‰ç›®å‰åœ¨<strong>å•ç‚¹ç™»å½•ï¼ˆSSOï¼‰</strong>ä¸­æ¯”è¾ƒå¹¿æ³›çš„ä½¿ç”¨äº†è¯¥æŠ€æœ¯ã€‚ ä¿¡æ¯äº¤æ¢åœ¨é€šä¿¡çš„åŒæ–¹ä¹‹é—´ä½¿ç”¨JWTå¯¹æ•°æ®è¿›è¡Œç¼–ç æ˜¯ä¸€ç§éå¸¸å®‰å…¨çš„æ–¹å¼ï¼Œ<strong>ç”±äºå®ƒçš„ä¿¡æ¯æ˜¯ç»è¿‡ç­¾åçš„ï¼Œå¯ä»¥ç¡®ä¿å‘é€è€…å‘é€çš„ä¿¡æ¯æ˜¯æ²¡æœ‰ç»è¿‡ä¼ªé€ çš„ã€‚</strong></p>
<p><strong>ä¼˜ç‚¹</strong></p>
<ol>
<li><p>ç®€æ´(Compact): å¯ä»¥é€šè¿‡URLï¼ŒPOSTå‚æ•°æˆ–è€…åœ¨HTTP headerå‘é€ï¼Œå› ä¸ºæ•°æ®é‡å°ï¼Œä¼ è¾“é€Ÿåº¦ä¹Ÿå¾ˆå¿«</p>
</li>
<li><p>è‡ªåŒ…å«(Self-contained)ï¼šè´Ÿè½½ä¸­åŒ…å«äº†æ‰€æœ‰ç”¨æˆ·æ‰€éœ€è¦çš„ä¿¡æ¯ï¼Œé¿å…äº†å¤šæ¬¡æŸ¥è¯¢æ•°æ®åº“</p>
</li>
<li><p>å› ä¸ºTokenæ˜¯ä»¥JSONåŠ å¯†çš„å½¢å¼ä¿å­˜åœ¨å®¢æˆ·ç«¯çš„ï¼Œæ‰€ä»¥JWTæ˜¯è·¨è¯­è¨€çš„ï¼ŒåŸåˆ™ä¸Šä»»ä½•webå½¢å¼éƒ½æ”¯æŒã€‚</p>
</li>
<li><p>ä¸éœ€è¦åœ¨æœåŠ¡ç«¯ä¿å­˜ä¼šè¯ä¿¡æ¯ï¼Œç‰¹åˆ«é€‚ç”¨äºåˆ†å¸ƒå¼å¾®æœåŠ¡ã€‚</p>
</li>
</ol>
<p><strong>JWTçš„ç»“æ„</strong></p>
<p><strong>JWTæ˜¯ç”±ä¸‰æ®µä¿¡æ¯æ„æˆçš„ï¼Œå°†è¿™ä¸‰æ®µä¿¡æ¯æ–‡æœ¬ç”¨.è¿æ¥ä¸€èµ·å°±æ„æˆäº†JWTå­—ç¬¦ä¸²ã€‚</strong><br>å°±åƒè¿™æ ·:<br><code>eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiYWRtaW4iOnRydWV9.TJVA95OrM7E2cBab30RMHrHDcEfxjoYZgeFONFh7HgQ</code></p>
<p><strong>JWTåŒ…å«äº†ä¸‰éƒ¨åˆ†ï¼š</strong></p>
<ul>
<li>Header å¤´éƒ¨(æ ‡é¢˜åŒ…å«äº†ä»¤ç‰Œçš„å…ƒæ•°æ®ï¼Œå¹¶ä¸”åŒ…å«ç­¾åå’Œ/æˆ–åŠ å¯†ç®—æ³•çš„ç±»å‹)</li>
<li>Payload è´Ÿè½½ (ç±»ä¼¼äºé£æœºä¸Šæ‰¿è½½çš„ç‰©å“)</li>
<li>Signature ç­¾å/ç­¾è¯</li>
</ul>
<p><strong>Header</strong></p>
<p><strong>JWTçš„å¤´éƒ¨æ‰¿è½½ä¸¤éƒ¨åˆ†ä¿¡æ¯ï¼štokenç±»å‹å’Œé‡‡ç”¨çš„åŠ å¯†ç®—æ³•ã€‚</strong></p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123; </span><br><span class="line">  <span class="attr">"alg"</span>: <span class="string">"HS256"</span>,</span><br><span class="line">   <span class="attr">"typ"</span>: <span class="string">"JWT"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>å£°æ˜ç±»å‹:è¿™é‡Œæ˜¯jwt</strong></p>
<p><strong>å£°æ˜åŠ å¯†çš„ç®—æ³•:é€šå¸¸ç›´æ¥ä½¿ç”¨ HMAC SHA256</strong></p>
<p><strong>åŠ å¯†ç®—æ³•æ˜¯å•å‘å‡½æ•°æ•£åˆ—ç®—æ³•ï¼Œå¸¸è§çš„æœ‰MD5ã€SHAã€HAMCã€‚</strong></p>
<ul>
<li>MD5(message-digest algorithm 5) ï¼ˆä¿¡æ¯-æ‘˜è¦ç®—æ³•ï¼‰ç¼©å†™ï¼Œå¹¿æ³›ç”¨äºåŠ å¯†å’Œè§£å¯†æŠ€æœ¯ï¼Œå¸¸ç”¨äºæ–‡ä»¶æ ¡éªŒã€‚æ ¡éªŒï¼Ÿä¸ç®¡æ–‡ä»¶å¤šå¤§ï¼Œç»è¿‡MD5åéƒ½èƒ½ç”Ÿæˆå”¯ä¸€çš„MD5å€¼</li>
<li>SHA (Secure Hash Algorithmï¼Œå®‰å…¨æ•£åˆ—ç®—æ³•ï¼‰ï¼Œæ•°å­—ç­¾åç­‰å¯†ç å­¦åº”ç”¨ä¸­é‡è¦çš„å·¥å…·ï¼Œå®‰å…¨æ€§é«˜äºMD5</li>
<li>HMAC (Hash Message Authentication Code)ï¼Œæ•£åˆ—æ¶ˆæ¯é‰´åˆ«ç ï¼ŒåŸºäºå¯†é’¥çš„Hashç®—æ³•çš„è®¤è¯åè®®ã€‚ç”¨å…¬å¼€å‡½æ•°å’Œå¯†é’¥äº§ç”Ÿä¸€ä¸ªå›ºå®šé•¿åº¦çš„å€¼ä½œä¸ºè®¤è¯æ ‡è¯†ï¼Œç”¨è¿™ä¸ªæ ‡è¯†é‰´åˆ«æ¶ˆæ¯çš„å®Œæ•´æ€§ã€‚å¸¸ç”¨äºæ¥å£ç­¾åéªŒè¯</li>
</ul>
<p><strong>Payload</strong></p>
<p>è½½è·å°±æ˜¯å­˜æ”¾æœ‰æ•ˆä¿¡æ¯çš„åœ°æ–¹ã€‚<br><strong>æœ‰æ•ˆä¿¡æ¯åŒ…å«ä¸‰ä¸ªéƒ¨åˆ†</strong></p>
<ol>
<li><p>æ ‡å‡†ä¸­æ³¨å†Œçš„å£°æ˜</p>
</li>
<li><p>å…¬å…±çš„å£°æ˜</p>
</li>
<li><p>ç§æœ‰çš„å£°æ˜</p>
<p><strong>æ ‡å‡†ä¸­æ³¨å†Œçš„å£°æ˜ (å»ºè®®ä½†ä¸å¼ºåˆ¶ä½¿ç”¨) ï¼š</strong></p>
</li>
</ol>
<ul>
<li><p>iss: jwtç­¾å‘è€…</p>
</li>
<li><p>sub: é¢å‘çš„ç”¨æˆ·(jwtæ‰€é¢å‘çš„ç”¨æˆ·)</p>
</li>
<li><p>aud: æ¥æ”¶jwtçš„ä¸€æ–¹</p>
</li>
<li><p>exp: è¿‡æœŸæ—¶é—´æˆ³(jwtçš„è¿‡æœŸæ—¶é—´ï¼Œè¿™ä¸ªè¿‡æœŸæ—¶é—´å¿…é¡»è¦å¤§äºç­¾å‘æ—¶é—´)</p>
</li>
<li><p>nbf: å®šä¹‰åœ¨ä»€ä¹ˆæ—¶é—´ä¹‹å‰ï¼Œè¯¥jwtéƒ½æ˜¯ä¸å¯ç”¨çš„.</p>
</li>
<li><p>iat: jwtçš„ç­¾å‘æ—¶é—´jti: jwtçš„å”¯ä¸€èº«ä»½æ ‡è¯†ï¼Œä¸»è¦ç”¨æ¥ä½œä¸ºä¸€æ¬¡æ€§</p>
</li>
<li><p>token,ä»è€Œå›é¿é‡æ”¾æ”»å‡»ã€‚</p>
<p><strong>å…¬å…±çš„å£°æ˜ ï¼š</strong></p>
</li>
</ul>
<p>å…¬å…±çš„å£°æ˜å¯ä»¥æ·»åŠ ä»»ä½•çš„ä¿¡æ¯ï¼Œä¸€èˆ¬æ·»åŠ ç”¨æˆ·çš„ç›¸å…³ä¿¡æ¯æˆ–å…¶ä»–ä¸šåŠ¡éœ€è¦çš„å¿…è¦ä¿¡æ¯.ä½†ä¸å»ºè®®æ·»åŠ æ•æ„Ÿä¿¡æ¯ï¼Œå› ä¸ºè¯¥éƒ¨åˆ†åœ¨å®¢æˆ·ç«¯å¯è§£å¯†.</p>
<p><strong>ç§æœ‰çš„å£°æ˜ ï¼š</strong></p>
<p>ç§æœ‰å£°æ˜æ˜¯æä¾›è€…å’Œæ¶ˆè´¹è€…æ‰€å…±åŒå®šä¹‰çš„å£°æ˜ï¼Œä¸€èˆ¬ä¸å»ºè®®å­˜æ”¾æ•æ„Ÿä¿¡æ¯ï¼Œå› ä¸ºbase64æ˜¯å¯¹ç§°è§£å¯†çš„ï¼Œæ„å‘³ç€è¯¥éƒ¨åˆ†ä¿¡æ¯å¯ä»¥å½’ç±»ä¸ºæ˜æ–‡ä¿¡æ¯ã€‚</p>
<p><strong>Signature</strong></p>
<p><strong>jwtçš„ç¬¬ä¸‰éƒ¨åˆ†æ˜¯ä¸€ä¸ªç­¾è¯ä¿¡æ¯ï¼Œè¿™ä¸ªç­¾è¯ä¿¡æ¯ç”±ä¸‰éƒ¨åˆ†ç»„æˆï¼š</strong></p>
<ul>
<li><p>header (base64åçš„)</p>
</li>
<li><p>payload (base64åçš„)</p>
</li>
<li><p>secret</p>
</li>
</ul>
<p>â€‹        è¿™ä¸ªéƒ¨åˆ†éœ€è¦base64åŠ å¯†åçš„headerå’Œbase64åŠ å¯†åçš„payloadä½¿ç”¨ . è¿æ¥ç»„æˆçš„å­—ç¬¦ä¸²ï¼Œç„¶åé€šè¿‡headerä¸­å£°æ˜çš„åŠ å¯†æ–¹å¼è¿›è¡ŒåŠ ç›secretç»„åˆåŠ å¯†ï¼Œç„¶åå°±æ„æˆäº†jwtçš„ç¬¬ä¸‰éƒ¨åˆ†ã€‚<br>å¯†é’¥secretæ˜¯ä¿å­˜åœ¨æœåŠ¡ç«¯çš„ï¼ŒæœåŠ¡ç«¯ä¼šæ ¹æ®è¿™ä¸ªå¯†é’¥è¿›è¡Œç”Ÿæˆtokenå’Œè¿›è¡ŒéªŒè¯ï¼Œæ‰€ä»¥éœ€è¦ä¿æŠ¤å¥½ã€‚</p>
<h5 id="5-é¡¹ç›®"><a href="#5-é¡¹ç›®" class="headerlink" title="5.é¡¹ç›®"></a>5.é¡¹ç›®</h5><h6 id="é¡¹ç›®ç»“æ„"><a href="#é¡¹ç›®ç»“æ„" class="headerlink" title="é¡¹ç›®ç»“æ„"></a>é¡¹ç›®ç»“æ„</h6><p><img src="/2019/10/13/SpringBoot-Token/%E9%A1%B9%E7%9B%AE%E7%BB%93%E6%9E%84.PNG" alt></p>
<h6 id="é¡¹ç›®ä¾èµ–ï¼š"><a href="#é¡¹ç›®ä¾èµ–ï¼š" class="headerlink" title="é¡¹ç›®ä¾èµ–ï¼š"></a>é¡¹ç›®ä¾èµ–ï¼š</h6><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.auth0<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>java-jwt<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">version</span>&gt;</span>3.4.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">scope</span>&gt;</span>runtime<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">version</span>&gt;</span>5.1.37<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis.spring.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">version</span>&gt;</span>1.3.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>fastjson<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.47<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">version</span>&gt;</span>1.16.22<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h5 id="6-å®ç°æ­¥éª¤"><a href="#6-å®ç°æ­¥éª¤" class="headerlink" title="6.å®ç°æ­¥éª¤"></a>6.å®ç°æ­¥éª¤</h5><h6 id="6-1-è‡ªå®šä¹‰ä¸¤ä¸ªæ³¨è§£"><a href="#6-1-è‡ªå®šä¹‰ä¸¤ä¸ªæ³¨è§£" class="headerlink" title="6.1 è‡ªå®šä¹‰ä¸¤ä¸ªæ³¨è§£"></a>6.1 è‡ªå®šä¹‰ä¸¤ä¸ªæ³¨è§£</h6><p><strong>ç”¨æ¥è·³è¿‡éªŒè¯çš„PassToken</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Target</span>(&#123;ElementType.METHOD, ElementType.TYPE&#125;)</span><br><span class="line"><span class="meta">@Retention</span>(RetentionPolicy.RUNTIME)</span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> PassToken &#123;</span><br><span class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">required</span><span class="params">()</span> <span class="keyword">default</span> <span class="keyword">true</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>éœ€è¦ç™»å½•æ‰èƒ½è¿›è¡Œæ“ä½œçš„æ³¨è§£UserLoginToken</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Target</span>(&#123;ElementType.METHOD, ElementType.TYPE&#125;)</span><br><span class="line"><span class="meta">@Retention</span>(RetentionPolicy.RUNTIME)</span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> UserLoginToken &#123;</span><br><span class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">required</span><span class="params">()</span> <span class="keyword">default</span> <span class="keyword">true</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>@Target</code>:æ³¨è§£çš„ä½œç”¨ç›®æ ‡</p>
<p>@Target(ElementType.TYPE)â€”â€”æ¥å£ã€ç±»ã€æšä¸¾ã€æ³¨è§£</p>
<p>@Target(ElementType.FIELD)â€”â€”å­—æ®µã€æšä¸¾çš„å¸¸é‡</p>
<p>@Target(ElementType.METHOD)â€”â€”æ–¹æ³•</p>
<p>@Target(ElementType.PARAMETER)â€”â€”æ–¹æ³•å‚æ•°</p>
<p>@Target(ElementType.CONSTRUCTOR) â€”â€”æ„é€ å‡½æ•°</p>
<p>@Target(ElementType.LOCAL_VARIABLE)â€”â€”å±€éƒ¨å˜é‡</p>
<p>@Target(ElementType.ANNOTATION_TYPE)â€”â€”æ³¨è§£</p>
<p>@Target(ElementType.PACKAGE)â€”â€”åŒ…</p>
<p><code>@Retention</code>ï¼šæ³¨è§£çš„ä¿ç•™ä½ç½®**</p>
<p>RetentionPolicy.SOURCE:è¿™ç§ç±»å‹çš„Annotationsåªåœ¨æºä»£ç çº§åˆ«ä¿ç•™,ç¼–è¯‘æ—¶å°±ä¼šè¢«å¿½ç•¥,åœ¨classå­—èŠ‚ç æ–‡ä»¶ä¸­ä¸åŒ…å«ã€‚</p>
<p>RetentionPolicy.CLASS:è¿™ç§ç±»å‹çš„Annotationsç¼–è¯‘æ—¶è¢«ä¿ç•™,é»˜è®¤çš„ä¿ç•™ç­–ç•¥,åœ¨classæ–‡ä»¶ä¸­å­˜åœ¨,ä½†JVMå°†ä¼šå¿½ç•¥,è¿è¡Œæ—¶æ— æ³•è·å¾—ã€‚</p>
<p>RetentionPolicy.RUNTIME:è¿™ç§ç±»å‹çš„Annotationså°†è¢«JVMä¿ç•™,æ‰€ä»¥ä»–ä»¬èƒ½åœ¨è¿è¡Œæ—¶è¢«JVMæˆ–å…¶ä»–ä½¿ç”¨åå°„æœºåˆ¶çš„ä»£ç æ‰€è¯»å–å’Œä½¿ç”¨ã€‚<br>@Documentï¼šè¯´æ˜è¯¥æ³¨è§£å°†è¢«åŒ…å«åœ¨javadocä¸­</p>
<p>@Inheritedï¼šè¯´æ˜å­ç±»å¯ä»¥ç»§æ‰¿çˆ¶ç±»ä¸­çš„è¯¥æ³¨è§£***</p>
<h6 id="6-2-å®ä½“ç±»"><a href="#6-2-å®ä½“ç±»" class="headerlink" title="6.2 å®ä½“ç±»"></a>6.2 å®ä½“ç±»</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String Id;</span><br><span class="line">    <span class="keyword">private</span> String username;</span><br><span class="line">    <span class="keyword">private</span> String password;</span><br><span class="line">	...	<span class="comment">//çœç•¥setå’Œgetæ–¹æ³•ï¼Œæˆ–è€…å¯ä»¥ä½¿ç”¨lombokç®€åŒ–å®ä½“ç±»çš„ç¼–å†™</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h6 id="6-3-è¿”å›ä½“"><a href="#6-3-è¿”å›ä½“" class="headerlink" title="6.3 è¿”å›ä½“"></a>6.3 è¿”å›ä½“</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Builder</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ResponseTemplate</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> Integer code;</span><br><span class="line">    <span class="keyword">public</span> String message;</span><br><span class="line">    <span class="keyword">public</span> Object data;</span><br><span class="line">	...	<span class="comment">//çœç•¥setå’Œgetæ–¹æ³•ï¼Œæˆ–è€…å¯ä»¥ä½¿ç”¨lombokç®€åŒ–å®ä½“ç±»çš„ç¼–å†™</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä½¿ç”¨äº†@Bulideæ³¨è§£åï¼Œå°±å¯ä»¥ä½¿ç”¨é“¾å¼é£æ ¼ä¼˜é›…åœ°åˆ›å»ºå¯¹è±¡ï¼Œæ¯”å¦‚ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ResponseTemplate.builder().code(<span class="number">200</span>).message(<span class="string">"æµ‹è¯•æˆåŠŸ"</span>).data(<span class="string">"æµ‹è¯•ğŸ“•"</span>).build();</span><br></pre></td></tr></table></figure>

<h6 id="6-4åˆ›å»ºä¸€ä¸ªæ‹¦æˆªå™¨é…ç½®ï¼Œç”¨äºæ‹¦æˆªå‰ç«¯è¯·æ±‚ï¼Œå®ç°-WebMvcConfigurer-æ¥å£"><a href="#6-4åˆ›å»ºä¸€ä¸ªæ‹¦æˆªå™¨é…ç½®ï¼Œç”¨äºæ‹¦æˆªå‰ç«¯è¯·æ±‚ï¼Œå®ç°-WebMvcConfigurer-æ¥å£" class="headerlink" title="6.4åˆ›å»ºä¸€ä¸ªæ‹¦æˆªå™¨é…ç½®ï¼Œç”¨äºæ‹¦æˆªå‰ç«¯è¯·æ±‚ï¼Œå®ç° WebMvcConfigurer æ¥å£"></a>6.4åˆ›å»ºä¸€ä¸ªæ‹¦æˆªå™¨é…ç½®ï¼Œç”¨äºæ‹¦æˆªå‰ç«¯è¯·æ±‚ï¼Œå®ç° WebMvcConfigurer æ¥å£</h6><ul>
<li>é‡å†™addHandlerInterceptionæ–¹æ³•ï¼Œå°†ç™»å½•æ‹¦æˆªå™¨æ³¨å†Œåˆ°web mvcé…ç½®ä¸­ï¼ŒæŒ‡æ˜æ‹¦æˆªçš„URL</li>
<li>åœ¨é…ç½®ç±»ä¸Šæ·»åŠ äº†æ³¨è§£@Configurationï¼Œæ ‡æ˜äº†è¯¥ç±»æ˜¯ä¸€ä¸ªé…ç½®ç±»å¹¶ä¸”ä¼šå°†è¯¥ç±»ä½œä¸ºä¸€ä¸ªSpringBeanæ·»åŠ åˆ°IOCå®¹å™¨å†…</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">InterceptorConfig</span> <span class="keyword">implements</span> <span class="title">WebMvcConfigurer</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addInterceptors</span><span class="params">(InterceptorRegistry registry)</span> </span>&#123;</span><br><span class="line">        registry.addInterceptor(authenticationInterceptor()).addPathPatterns(<span class="string">"/**"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> AuthenticationInterceptor <span class="title">authenticationInterceptor</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> AuthenticationInterceptor();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>â€‹         InterceptorRegistryå†…çš„addInterceptoréœ€è¦ä¸€ä¸ªå®ç°HandlerInterceptoræ¥å£çš„æ‹¦æˆªå™¨å®ä¾‹ï¼ŒaddPathPatternsæ–¹æ³•ç”¨äºè®¾ç½®æ‹¦æˆªå™¨çš„è¿‡æ»¤è·¯å¾„è§„åˆ™ã€‚<br>è¿™é‡Œéœ€è¦æ‹¦æˆªæ‰€æœ‰è¯·æ±‚ï¼Œé€šè¿‡åˆ¤æ–­æ˜¯å¦æœ‰@UserLoginTokenæ³¨è§£ å†³å®šæ˜¯å¦éœ€è¦ç™»å½•</p>
<h6 id="6-5-åˆ›å»ºä¸€ä¸ªæ‹¦æˆªå™¨ï¼Œç»§æ‰¿HandlerInterceptionæ¥å£ï¼Œå®ç°æ‹¦æˆªè¿˜æ˜¯æ”¾é€šçš„é€»è¾‘ï¼Œæ‹¦æˆªåéœ€è¦è·å–tokenå¹¶æ ¡éªŒ"><a href="#6-5-åˆ›å»ºä¸€ä¸ªæ‹¦æˆªå™¨ï¼Œç»§æ‰¿HandlerInterceptionæ¥å£ï¼Œå®ç°æ‹¦æˆªè¿˜æ˜¯æ”¾é€šçš„é€»è¾‘ï¼Œæ‹¦æˆªåéœ€è¦è·å–tokenå¹¶æ ¡éªŒ" class="headerlink" title="6.5 åˆ›å»ºä¸€ä¸ªæ‹¦æˆªå™¨ï¼Œç»§æ‰¿HandlerInterceptionæ¥å£ï¼Œå®ç°æ‹¦æˆªè¿˜æ˜¯æ”¾é€šçš„é€»è¾‘ï¼Œæ‹¦æˆªåéœ€è¦è·å–tokenå¹¶æ ¡éªŒ"></a>6.5 åˆ›å»ºä¸€ä¸ªæ‹¦æˆªå™¨ï¼Œç»§æ‰¿HandlerInterceptionæ¥å£ï¼Œå®ç°æ‹¦æˆªè¿˜æ˜¯æ”¾é€šçš„é€»è¾‘ï¼Œæ‹¦æˆªåéœ€è¦è·å–tokenå¹¶æ ¡éªŒ</h6><p><strong>HandlerInterceptoræ¥å£ä¸»è¦å®šä¹‰äº†ä¸‰ä¸ªæ–¹æ³•</strong></p>
<ol>
<li><p>boolean preHandle (HttpServletRequest request, HttpServletResponse response, Object handler)ï¼š</p>
<p>é¢„å¤„ç†å›è°ƒæ–¹æ³•,å®ç°å¤„ç†å™¨çš„é¢„å¤„ç†ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°ä¸ºå“åº”çš„å¤„ç†å™¨,è‡ªå®šä¹‰Controller,è¿”å›å€¼ä¸ºtrueè¡¨ç¤ºç»§ç»­æµç¨‹ï¼ˆå¦‚è°ƒç”¨ä¸‹ä¸€ä¸ªæ‹¦æˆªå™¨æˆ–å¤„ç†å™¨ï¼‰æˆ–è€…æ¥ç€æ‰§è¡ŒpostHandle()å’ŒafterCompletion()ï¼›falseè¡¨ç¤ºæµç¨‹ä¸­æ–­ï¼Œä¸ä¼šç»§ç»­è°ƒç”¨å…¶ä»–çš„æ‹¦æˆªå™¨æˆ–å¤„ç†å™¨ï¼Œä¸­æ–­æ‰§è¡Œã€‚</p>
</li>
<li><p>void postHandle()ï¼š</p>
<p>åå¤„ç†å›è°ƒæ–¹æ³•ï¼Œå®ç°å¤„ç†å™¨çš„åå¤„ç†ï¼ˆDispatcherServletè¿›è¡Œè§†å›¾è¿”å›æ¸²æŸ“ä¹‹å‰è¿›è¡Œè°ƒç”¨ï¼‰ï¼Œæ­¤æ—¶æˆ‘ä»¬å¯ä»¥é€šè¿‡modelAndViewï¼ˆæ¨¡å‹å’Œè§†å›¾å¯¹è±¡ï¼‰å¯¹æ¨¡å‹æ•°æ®è¿›è¡Œå¤„ç†æˆ–å¯¹è§†å›¾è¿›è¡Œå¤„ç†ï¼ŒmodelAndViewä¹Ÿå¯èƒ½ä¸ºnullã€‚</p>
</li>
<li><p>void afterCompletion():</p>
<p>æ•´ä¸ªè¯·æ±‚å¤„ç†å®Œæ¯•å›è°ƒæ–¹æ³•,è¯¥æ–¹æ³•ä¹Ÿæ˜¯éœ€è¦å½“å‰å¯¹åº”çš„Interceptorçš„preHandle()çš„è¿”å›å€¼ä¸ºtrueæ—¶æ‰ä¼šæ‰§è¡Œï¼Œä¹Ÿå°±æ˜¯åœ¨DispatcherServletæ¸²æŸ“äº†å¯¹åº”çš„è§†å›¾ä¹‹åæ‰§è¡Œã€‚ç”¨äºè¿›è¡Œèµ„æºæ¸…ç†ã€‚æ•´ä¸ªè¯·æ±‚å¤„ç†å®Œæ¯•å›è°ƒæ–¹æ³•ã€‚å¦‚æ€§èƒ½ç›‘æ§ä¸­æˆ‘ä»¬å¯ä»¥åœ¨æ­¤è®°å½•ç»“æŸæ—¶é—´å¹¶è¾“å‡ºæ¶ˆè€—æ—¶é—´ï¼Œè¿˜å¯ä»¥è¿›è¡Œä¸€äº›èµ„æºæ¸…ç†ï¼Œç±»ä¼¼äºtry-catch-finallyä¸­çš„finallyï¼Œä½†ä»…è°ƒç”¨å¤„ç†å™¨æ‰§è¡Œé“¾ä¸­</p>
<p>é‡å†™preHandleræ–¹æ³•ï¼Œè¿”å›ç±»å‹ä¸ºå¸ƒå°”å‹ï¼Œtrueä»£è¡¨æ”¾è¡Œï¼Œfalseä»£è¡¨ä¸æ”¾è¡Œï¼Œä¸»è¦æµç¨‹å¦‚ä¸‹ï¼š</p>
</li>
</ol>
<ul>
<li>ä» http è¯·æ±‚å¤´ä¸­å–å‡º token</li>
<li>åˆ¤æ–­æ˜¯å¦æ˜ å°„åˆ°æ–¹æ³•ï¼Œå¦‚æœä¸æ˜¯æ˜ å°„åˆ°æ–¹æ³•ç›´æ¥é€šè¿‡</li>
<li>æ£€æŸ¥æ˜¯å¦æœ‰passtokenæ³¨é‡Šï¼Œæœ‰åˆ™è·³è¿‡è®¤è¯</li>
<li>æ£€æŸ¥æœ‰æ²¡æœ‰éœ€è¦ç”¨æˆ·ç™»å½•çš„æ³¨è§£ï¼Œæœ‰åˆ™éœ€è¦å–å‡ºå¹¶éªŒè¯</li>
<li>è®¤è¯é€šè¿‡åˆ™å¯ä»¥è®¿é—®ï¼Œä¸é€šè¿‡ä¼šæŠ¥ç›¸å…³é”™è¯¯ä¿¡æ¯</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AuthenticationInterceptor</span> <span class="keyword">implements</span> <span class="title">HandlerInterceptor</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    UserService userService;</span><br><span class="line"></span><br><span class="line">    Logger log = LoggerFactory.getLogger(AuthenticationInterceptor<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">preHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="comment">//ä»httpè¯·æ±‚å–å‡ºtoken</span></span><br><span class="line">        String token = request.getHeader(<span class="string">"token"</span>);</span><br><span class="line">        log.info(<span class="string">"è·å–åˆ°çš„tokenä¸ºï¼š&#123;&#125;"</span>, token);</span><br><span class="line">        <span class="comment">//å¦‚æœä¸æ˜¯æ˜ å°„åˆ°æ–¹æ³•ç›´æ¥é€šè¿‡</span></span><br><span class="line">        <span class="keyword">if</span> (!(handler <span class="keyword">instanceof</span> HandlerMethod)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        HandlerMethod handlerMethod = (HandlerMethod) handler;</span><br><span class="line">        Method method = handlerMethod.getMethod();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//æ˜¯å¦æœ‰passtokenæ³¨é‡Šï¼Œæœ‰åˆ™è·³è¿‡è®¤è¯</span></span><br><span class="line">        <span class="keyword">if</span> (method.isAnnotationPresent(PassToken<span class="class">.<span class="keyword">class</span>)) </span>&#123;</span><br><span class="line">            PassToken passToken = method.getAnnotation(PassToken<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">            <span class="keyword">if</span> (passToken.required()) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//æœ‰æ²¡æœ‰éœ€è¦ç”¨æˆ·æƒé™çš„æ³¨è§£</span></span><br><span class="line">        <span class="keyword">if</span> (method.isAnnotationPresent(UserLoginToken<span class="class">.<span class="keyword">class</span>)) </span>&#123;</span><br><span class="line">            UserLoginToken userLoginToken = method.getAnnotation(UserLoginToken<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">            <span class="keyword">if</span> (userLoginToken.required()) &#123;</span><br><span class="line">                <span class="comment">//æ‰§è¡Œè®¤è¯</span></span><br><span class="line">                <span class="keyword">if</span> (token == <span class="keyword">null</span>) &#123;</span><br><span class="line">                    <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">"æ— tokenï¼Œè¯·é‡æ–°ç™»å½•"</span>);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">//è·å–tokenä¸­çš„user id</span></span><br><span class="line">                String userId;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    userId = JWT.decode(token).getAudience().get(<span class="number">0</span>);</span><br><span class="line">                &#125; <span class="keyword">catch</span> (JWTDecodeException e) &#123;</span><br><span class="line">                    log.info(<span class="string">"Tokenéæ³•"</span>);</span><br><span class="line">                    <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">"401,Tokenéæ³•"</span>);</span><br><span class="line">                &#125;</span><br><span class="line">                User user = userService.finduserbyId(userId);</span><br><span class="line">                <span class="keyword">if</span> (user == <span class="keyword">null</span>) &#123;</span><br><span class="line">                    log.info(<span class="string">"ç”¨æˆ·ä¸å­˜åœ¨ï¼Œè¯·é‡æ–°ç™»å½•!"</span>);</span><br><span class="line">                    <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">"ç”¨æˆ·ä¸å­˜åœ¨ï¼Œè¯·é‡æ–°ç™»å½•!"</span>);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">//éªŒè¯token</span></span><br><span class="line">                JWTVerifier jwtVerifier = JWT.require(Algorithm.HMAC256(user.getPassword())).build();</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    jwtVerifier.verify(token);</span><br><span class="line">                &#125; <span class="keyword">catch</span> (JWTVerificationException e) &#123;</span><br><span class="line">                    log.info(<span class="string">"401,Tokenéæ³•"</span>);</span><br><span class="line">                    <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">"401,Tokenéæ³•"</span>);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">postHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler, ModelAndView modelAndView)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">afterCompletion</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h6 id="6-6-controllerå±‚åŠ å…¥ç™»å½•æ“ä½œæ³¨è§£"><a href="#6-6-controllerå±‚åŠ å…¥ç™»å½•æ“ä½œæ³¨è§£" class="headerlink" title="6.6 controllerå±‚åŠ å…¥ç™»å½•æ“ä½œæ³¨è§£"></a>6.6 controllerå±‚åŠ å…¥ç™»å½•æ“ä½œæ³¨è§£</h6><p>â€‹        ä¸åŠ æ³¨è§£çš„è¯é»˜è®¤ä¸éªŒè¯ï¼Œç™»å½•æ¥å£ä¸€èˆ¬æ˜¯ä¸éªŒè¯çš„ã€‚åœ¨getMessage()ä¸Šäº†ç™»å½•æ³¨è§£ï¼Œè¯´æ˜è¯¥æ¥å£å¿…é¡»ç™»å½•è·å–tokenåï¼Œåœ¨è¯·æ±‚å¤´ä¸­åŠ ä¸Štokenå¹¶é€šè¿‡éªŒè¯æ‰å¯ä»¥è®¿é—®</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    Logger logger = LoggerFactory.getLogger(UserController<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    UserService userService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    TokenService tokenService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping</span>(<span class="string">"/wlecome"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">welcome</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"welcome TokenController"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping</span>(value = <span class="string">"/login"</span>, method = RequestMethod.GET)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">login</span><span class="params">(User user, HttpServletResponse response)</span> </span>&#123;</span><br><span class="line">        JSONObject jsonObject = <span class="keyword">new</span> JSONObject();</span><br><span class="line">        logger.info(<span class="string">"ç”¨æˆ·åusernameä¸º:"</span> + user.getUsername() + <span class="string">"å¯†ç passwordä¸º:"</span> + user.getPassword());</span><br><span class="line"></span><br><span class="line">        User userSearch = userService.getUser(user.getUsername(), user.getPassword());</span><br><span class="line">        <span class="keyword">if</span> (userSearch != <span class="keyword">null</span>) &#123;</span><br><span class="line">            String token = tokenService.getToken(userSearch);</span><br><span class="line">            jsonObject.put(<span class="string">"message"</span>, <span class="string">"ç”¨æˆ·ç™»å½•æˆåŠŸ!"</span>);</span><br><span class="line">            jsonObject.put(<span class="string">"token"</span>, token);</span><br><span class="line"></span><br><span class="line">            Cookie cookie = <span class="keyword">new</span> Cookie(<span class="string">"token"</span>, token);</span><br><span class="line">            cookie.setPath(<span class="string">"/"</span>);</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            jsonObject.put(<span class="string">"message"</span>, <span class="string">"ç™»é™†å¤±è´¥, å½“å‰ç”¨æˆ·ä¸å­˜åœ¨ï¼Œè¯·é‡æ–°è¾“å…¥ï¼"</span>);</span><br><span class="line">            <span class="keyword">return</span> ResponseTemplate.builder().code(<span class="number">500</span>).message(<span class="string">"è´¦å·æˆ–å¯†ç é”™è¯¯ï¼"</span>).data(jsonObject).build();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ResponseTemplate.builder().code(<span class="number">200</span>).message(<span class="string">"ç”¨æˆ·ç™»å½•æˆåŠŸ"</span>).data(jsonObject).build();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@UserLoginToken</span></span><br><span class="line">    <span class="meta">@RequestMapping</span>(value = <span class="string">"getMessage"</span>, method = RequestMethod.GET)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">getMessage</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        logger.info(<span class="string">"**************æµ‹è¯•start**************"</span>);</span><br><span class="line">        <span class="keyword">return</span> ResponseTemplate.builder().code(<span class="number">200</span>).message(<span class="string">"è®¿é—®æˆåŠŸ"</span>).data(<span class="string">"æºå¸¦Tokenï¼ŒæˆåŠŸè®¿é—®"</span>).build();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h6 id="6-7-serviceå±‚"><a href="#6-7-serviceå±‚" class="headerlink" title="6.7 serviceå±‚"></a>6.7 serviceå±‚</h6><p><strong>TokenService</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span>(<span class="string">"TokenService"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TokenService</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getToken</span><span class="params">(User user)</span> </span>&#123;</span><br><span class="line">        Date start = <span class="keyword">new</span> Date();</span><br><span class="line">        <span class="keyword">long</span> currentTime = System.currentTimeMillis() + <span class="number">60</span> * <span class="number">60</span> * <span class="number">1000</span>;<span class="comment">//Tokenä¸€å°æ—¶æœ‰æ•ˆ</span></span><br><span class="line">        Date end = <span class="keyword">new</span> Date(currentTime);</span><br><span class="line">        String token = <span class="string">""</span>;</span><br><span class="line"></span><br><span class="line">        token = JWT.create().withAudience(user.getId()).withIssuedAt(start).withExpiresAt(end)</span><br><span class="line">                .sign(Algorithm.HMAC256(user.getPassword()));</span><br><span class="line">        <span class="keyword">return</span> token;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>â€‹    æ–¹æ³•getToken(User user)ç”ŸæˆTokenï¼ŒAlgorithm.HMAC256(): ä½¿ç”¨HS256ç”Ÿæˆtoken,å¯†é’¥åˆ™æ˜¯ç”¨æˆ·çš„å¯†ç ï¼Œå”¯ä¸€å¯†é’¥çš„è¯å¯ä»¥ä¿å­˜åœ¨æœåŠ¡ç«¯ã€‚withAudience()å­˜å…¥éœ€è¦ä¿å­˜åœ¨tokençš„ä¿¡æ¯ï¼Œè¿™é‡ŒæŠŠç”¨æˆ·IDå­˜å…¥tokenä¸­ã€‚</p>
<p><strong>UserService</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span>(<span class="string">"UserService"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserService</span> </span>&#123;    </span><br><span class="line">    <span class="meta">@Autowired</span>    UserMapper userMapper;    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> User <span class="title">getUser</span><span class="params">(String username, String password)</span> </span>&#123;        </span><br><span class="line">        <span class="keyword">return</span> userMapper.findByUserNameAndPasswd(username,password);    &#125;    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> User <span class="title">finduserbyId</span><span class="params">(String userId)</span> </span>&#123;        </span><br><span class="line">        System.out.println(userId + <span class="string">"***************************"</span>);        </span><br><span class="line">        <span class="keyword">return</span> userMapper.findUserById(userId);    </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸¤ä¸ªæŸ¥æ‰¾Useræ–¹æ³•ï¼Œæ ¹æ®usernameå’Œpasswordï¼Œæˆ–idã€‚</p>
<p>@Serviceæ³¨è§£ï¼Œå°†è‡ªåŠ¨å°†è¯¥ç±»æ³¨å†Œåˆ°Springå®¹å™¨ä¸­ã€‚</p>
<h6 id="6-8-Daoå±‚"><a href="#6-8-Daoå±‚" class="headerlink" title="6.8 Daoå±‚"></a>6.8 Daoå±‚</h6><p><strong>UserMapper</strong>  Interface</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Mapper</span></span><br><span class="line"><span class="meta">@C</span></span><br><span class="line">omponent</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserMapper</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function">User <span class="title">findByUserNameAndPasswd</span><span class="params">(String username, String userpasswd)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Select</span>(<span class="string">"select * from user where id=#&#123;id&#125;"</span>)</span><br><span class="line">    <span class="function">User <span class="title">findUserById</span><span class="params">(@Param(<span class="string">"id"</span>)</span> String id)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>@Componentæ³¨è§£ï¼Œå°†è¯¥æ¥å£æ³¨å†Œæˆå•ä¾‹beanç»„ä»¶åˆ°Springå®¹å™¨ä¸­ã€‚</p>
<p><strong>UserMapper.xml</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version='1.0' encoding='UTF-8' ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span> <span class="meta-keyword">PUBLIC</span> <span class="meta-string">"-//mybatis.org//DTD Mapper 3.0//EN"</span> <span class="meta-string">"http://mybatis.org/dtd/mybatis-3-mapper.dtd"</span> &gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">"com.wu.springBootToken.mapper.UserMapper"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"findByUserNameAndPasswd"</span> <span class="attr">resultType</span>=<span class="string">"com.wu.springBootToken.entity.User"</span>&gt;</span></span><br><span class="line">        select * from user</span><br><span class="line">        where username=#&#123;username&#125; and password=#&#123;userpasswd&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h5 id="7-æµ‹è¯•"><a href="#7-æµ‹è¯•" class="headerlink" title="7. æµ‹è¯•"></a>7. æµ‹è¯•</h5><h6 id="7-1-åœ¨æ²¡tokençš„æƒ…å†µä¸‹è®¿é—®-getMessageæ¥å£"><a href="#7-1-åœ¨æ²¡tokençš„æƒ…å†µä¸‹è®¿é—®-getMessageæ¥å£" class="headerlink" title="7.1 åœ¨æ²¡tokençš„æƒ…å†µä¸‹è®¿é—®/getMessageæ¥å£"></a>7.1 åœ¨æ²¡tokençš„æƒ…å†µä¸‹è®¿é—®/getMessageæ¥å£</h6><p><img src="/2019/10/13/SpringBoot-Token/getMessageNoToken.PNG" alt></p>
<h6 id="7-2-ç”¨æˆ·åå’Œå¯†ç ç™»å½•"><a href="#7-2-ç”¨æˆ·åå’Œå¯†ç ç™»å½•" class="headerlink" title="7.2 ç”¨æˆ·åå’Œå¯†ç ç™»å½•"></a>7.2 ç”¨æˆ·åå’Œå¯†ç ç™»å½•</h6><p><img src="/2019/10/13/SpringBoot-Token/login.PNG" alt></p>
<h6 id="7-3-è¯·æ±‚å¤´æºå¸¦tokençš„æƒ…å†µä¸‹è®¿é—®-getMessageæ¥å£"><a href="#7-3-è¯·æ±‚å¤´æºå¸¦tokençš„æƒ…å†µä¸‹è®¿é—®-getMessageæ¥å£" class="headerlink" title="7.3 è¯·æ±‚å¤´æºå¸¦tokençš„æƒ…å†µä¸‹è®¿é—®/getMessageæ¥å£"></a>7.3 è¯·æ±‚å¤´æºå¸¦tokençš„æƒ…å†µä¸‹è®¿é—®/getMessageæ¥å£</h6><p><img src="/2019/10/13/SpringBoot-Token/getMessageWithToken.PNG" alt></p>
<h5 id="8-ç›¸å…³è¿æ¥"><a href="#8-ç›¸å…³è¿æ¥" class="headerlink" title="8.ç›¸å…³è¿æ¥"></a>8.ç›¸å…³è¿æ¥</h5><p><a href="https://github.com/AndersonBlog/springBootToken.git" target="_blank" rel="noopener">é¡¹ç›®é“¾æ¥</a></p>
<p>å‚è€ƒèµ„æ–™ï¼š</p>
<p><a href="https://blog.csdn.net/FindHuni/article/details/94451136" target="_blank" rel="noopener">https://blog.csdn.net/FindHuni/article/details/94451136</a>       </p>
<p><a href="https://www.cnblogs.com/ChromeT/p/10932202.html" target="_blank" rel="noopener">https://www.cnblogs.com/ChromeT/p/10932202.html</a></p>
<p><a href="https://www.jianshu.com/p/e88d3f8151db" target="_blank" rel="noopener">https://www.jianshu.com/p/e88d3f8151db</a></p>
<p>â€‹        </p>

      
    </div>

    
    
    
	<div>
		
	</div>
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/09/27/%E6%B5%85%E6%9E%90cookie-session-token/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/self.png">
      <meta itemprop="name" content="Anderson Wu">
      <meta itemprop="description" content="Love is love">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="é™ªä½ åº¦è¿‡æ¼«é•¿å²æœˆ">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/09/27/%E6%B5%85%E6%9E%90cookie-session-token/" class="post-title-link" itemprop="url">æµ…æcookieï¼Œsessionå’Œtoken</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2019-09-27 19:37:58" itemprop="dateCreated datePublished" datetime="2019-09-27T19:37:58+08:00">2019-09-27</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2020-03-28 17:09:26" itemprop="dateModified" datetime="2020-03-28T17:09:26+08:00">2020-03-28</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Cookie-seesion-Token/" itemprop="url" rel="index"><span itemprop="name">Cookie seesion Token</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h5 id="ä¸€ã€å‘å±•å²"><a href="#ä¸€ã€å‘å±•å²" class="headerlink" title="ä¸€ã€å‘å±•å²"></a>ä¸€ã€å‘å±•å²</h5><p>â€‹            ä»¥å‰ï¼ŒWebåº”ç”¨åŸºæœ¬éƒ½æ˜¯æ–‡æ¡£æµè§ˆï¼Œåœ¨æµè§ˆè¿‡ç¨‹ä¸­ï¼ŒæœåŠ¡å™¨æ— éœ€è®°å½•å“ªä½ç”¨æˆ·æµè§ˆäº†å“ªäº›æ–‡æ¡£ï¼Œæ‰€ä»¥æ¯æ¬¡è¯·æ±‚éƒ½æ˜¯æ–°çš„HTTPåè®®ï¼ˆè¯·æ±‚å’Œå“åº”ï¼‰ã€‚</p>
<p>â€‹            å½“æˆ‘ä»¬ç”¨æµè§ˆå™¨æ‰“å¼€ä¸€ä¸ªç½‘é¡µï¼Œç”¨åˆ°çš„æ˜¯HTTPåè®®ï¼Œå®ƒæ˜¯æ— çŠ¶æ€çš„ï¼Œå½“å‰è¯·æ±‚å’Œä¸Šä¸€æ¬¡è¯·æ±‚æ˜¯æ²¡æœ‰ä»»ä½•å…³ç³»çš„ï¼Œäº’ä¸å…³è”ã€‚ä½†æ˜¯è¿™ç§æ— çŠ¶æ€çš„çš„å¥½å¤„æ˜¯å¿«é€Ÿã€‚æ‰€ä»¥å°±ä¼šå¸¦æ¥ä¸€ä¸ªé—®é¢˜å°±æ˜¯ï¼Œå½“å‡ ä¸ªè¯·æ±‚çš„é¡µé¢è¦æœ‰å…³è”ï¼Œæ¯”å¦‚ï¼šæˆ‘åœ¨<a href="http://www.a.com/login.phpé‡Œé¢ç™»é™†äº†ï¼Œæˆ‘åœ¨www.a.com/index.php" target="_blank" rel="noopener">www.a.com/login.phpé‡Œé¢ç™»é™†äº†ï¼Œæˆ‘åœ¨www.a.com/index.php</a> ä¹Ÿå¸Œæœ›æ˜¯ç™»é™†çŠ¶æ€ï¼Œä½†æ˜¯ï¼Œè¿™æ˜¯2ä¸ªä¸åŒçš„é¡µé¢ï¼Œä¹Ÿå°±æ˜¯2ä¸ªä¸åŒçš„HTTPè¯·æ±‚ï¼Œè¿™2ä¸ªHTTPè¯·æ±‚æ˜¯æ— çŠ¶æ€çš„ï¼Œä¹Ÿå°±æ˜¯æ— å…³è”çš„ï¼Œæ‰€ä»¥æ— æ³•å•çº¯çš„åœ¨index.phpä¸­è¯»å–åˆ°å®ƒåœ¨login.phpä¸­å·²ç»ç™»é™†äº†ï¼</p>
<p>â€‹            å› ä¸ºä¸å¯èƒ½è¿™2ä¸ªé¡µé¢éƒ½å»ç™»é™†ä¸€æ¬¡æˆ–è€…2ä¸ªé¡µé¢éƒ½å»æŸ¥è¯¢æ•°æ®åº“ï¼Œå¦‚æœæœ‰ç™»é™†çŠ¶æ€ï¼Œå°±åˆ¤æ–­æ˜¯ç™»é™†çš„äº†ã€‚è¿™ç§æŸ¥è¯¢æ•°æ®åº“çš„æ–¹æ¡ˆè™½ç„¶å¯è¡Œï¼Œä½†æ˜¯æ¯æ¬¡éƒ½è¦å»æŸ¥è¯¢æ•°æ®åº“ï¼Œä¼šé€ æˆæ•°æ®åº“çš„å‹åŠ›ã€‚ </p>
<p>â€‹            ä¸ºäº†è§£å†³ä»¥ä¸Šé—®é¢˜ï¼Œä¸€ç§æ–°çš„å®¢æˆ·ç«¯å­˜å‚¨æ•°æ®æ–¹å¼å‡ºç°äº†ï¼šcookieã€‚cookieæ˜¯æŠŠå°‘é‡çš„ä¿¡æ¯å­˜å‚¨åœ¨ç”¨æˆ·è‡ªå·±çš„ç”µè„‘ä¸Šï¼Œå®ƒåœ¨ä¸€ä¸ªåŸŸåä¸‹æ˜¯ä¸€ä¸ªå…¨å±€çš„ï¼Œåªè¦è®¾ç½®å®ƒçš„å­˜å‚¨è·¯å¾„åœ¨åŸŸå<a href="http://www.a.comä¸‹" target="_blank" rel="noopener">www.a.comä¸‹</a> ï¼Œé‚£ä¹ˆå½“ç”¨æˆ·ç”¨æµè§ˆå™¨è®¿é—®æ—¶ï¼Œphpå°±å¯ä»¥ä»è¿™ä¸ªåŸŸåçš„ä»»æ„é¡µé¢è¯»å–cookieä¸­çš„ä¿¡æ¯ã€‚æ‰€ä»¥å°±å¾ˆå¥½çš„è§£å†³äº†æˆ‘åœ¨<a href="http://www.a.com/login.phpé¡µé¢ç™»é™†äº†ï¼Œæˆ‘ä¹Ÿå¯ä»¥åœ¨www.a.com/index.phpè·å–åˆ°è¿™ä¸ªç™»é™†ä¿¡æ¯äº†ã€‚åŒæ—¶åˆä¸ç”¨åå¤å»æŸ¥è¯¢æ•°æ®åº“ã€‚" target="_blank" rel="noopener">www.a.com/login.phpé¡µé¢ç™»é™†äº†ï¼Œæˆ‘ä¹Ÿå¯ä»¥åœ¨www.a.com/index.phpè·å–åˆ°è¿™ä¸ªç™»é™†ä¿¡æ¯äº†ã€‚åŒæ—¶åˆä¸ç”¨åå¤å»æŸ¥è¯¢æ•°æ®åº“ã€‚</a></p>
<p>â€‹            è™½ç„¶è¿™ç§æ–¹æ¡ˆå¾ˆä¸é”™ï¼Œä¹Ÿå¾ˆå¿«é€Ÿæ–¹ä¾¿ï¼Œä½†æ˜¯ç”±äºcookie æ˜¯å­˜åœ¨ç”¨æˆ·ç«¯ï¼Œè€Œä¸”å®ƒæœ¬èº«å­˜å‚¨çš„å°ºå¯¸å¤§å°ä¹Ÿæœ‰é™ï¼Œæœ€å…³é”®æ˜¯ç”¨æˆ·å¯ä»¥æ˜¯å¯è§çš„ï¼Œå¹¶å¯ä»¥éšæ„çš„ä¿®æ”¹ï¼Œå¾ˆä¸å®‰å…¨ã€‚é‚£å¦‚ä½•åˆè¦å®‰å…¨ï¼Œåˆå¯ä»¥æ–¹ä¾¿çš„å…¨å±€è¯»å–ä¿¡æ¯å‘¢ï¼Ÿäºæ˜¯ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œä¸€ç§æ–°çš„å­˜å‚¨ä¼šè¯æœºåˆ¶ï¼šsession è¯ç”Ÿäº†ã€‚</p>
<h5 id="äºŒã€cookie"><a href="#äºŒã€cookie" class="headerlink" title="äºŒã€cookie"></a>äºŒã€cookie</h5><p>â€‹            cookieæ˜¯æµè§ˆå™¨é‡Œé¢èƒ½æ°¸ä¹…å­˜å‚¨çš„æ•°æ®ï¼Œä»…ä»…æ˜¯æµè§ˆå™¨å®ç°çš„ä¸€ç§æ•°æ®å­˜å‚¨åŠŸèƒ½ã€‚</p>
<p>â€‹             cookieç”±æœåŠ¡å™¨ç”Ÿæˆï¼Œå‘é€ç»™æµè§ˆå™¨ï¼Œæµè§ˆå™¨æŠŠcookieä»¥k-vå½¢å¼ä¿å­˜åˆ°æŸä¸ªç›®å½•ä¸‹çš„æ–‡æœ¬æ–‡ä»¶å†…ï¼Œä¸‹ä¸€æ¬¡è¯·æ±‚åŒä¸€ç½‘ç«™æ—¶ä¼šæŠŠè¯¥cookieå‘é€ç»™æœåŠ¡å™¨ã€‚ç”±äºcookieæ˜¯å­˜åœ¨å®¢æˆ·ç«¯ä¸Šçš„ï¼Œæ‰€ä»¥æµè§ˆå™¨åŠ å…¥äº†ä¸€äº›é™åˆ¶ç¡®ä¿cookieä¸ä¼šè¢«æ¶æ„ä½¿ç”¨ï¼ŒåŒæ—¶ä¸ä¼šå æ®å¤ªå¤šç£ç›˜ç©ºé—´ï¼Œæ‰€ä»¥æ¯ä¸ªåŸŸçš„cookieæ•°é‡æ˜¯æœ‰é™çš„ã€‚</p>
<h5 id="ä¸‰ã€session"><a href="#ä¸‰ã€session" class="headerlink" title="ä¸‰ã€session"></a>ä¸‰ã€session</h5><p>â€‹            Session å°±æ˜¯åœ¨ä¸€æ¬¡ä¼šè¯ä¸­è§£å†³2æ¬¡HTTPçš„è¯·æ±‚çš„å…³è”ï¼Œè®©å®ƒä»¬äº§ç”Ÿè”ç³»ï¼Œè®©2ä¸¤ä¸ªé¡µé¢éƒ½èƒ½è¯»å–åˆ°æ‰¾ä¸ªè¿™ä¸ªå…¨å±€çš„sessionä¿¡æ¯ã€‚sessionä¿¡æ¯å­˜åœ¨äºæœåŠ¡å™¨ç«¯ï¼Œæ‰€ä»¥ä¹Ÿå°±å¾ˆå¥½çš„è§£å†³äº†å®‰å…¨é—®é¢˜ã€‚</p>
<p>â€‹            Sessionçš„ä¸­æ–‡ç¿»è¯‘æ˜¯â€œä¼šè¯â€ï¼Œå½“ç”¨æˆ·æ‰“å¼€æŸä¸ªwebåº”ç”¨æ—¶ï¼Œä¾¿ä¸webæœåŠ¡å™¨äº§ç”Ÿä¸€æ¬¡sessionã€‚æœåŠ¡å™¨ä½¿ç”¨sessionæŠŠç”¨æˆ·çš„ä¿¡æ¯ä¸´æ—¶ä¿å­˜åœ¨äº†æœåŠ¡å™¨ä¸Šï¼Œç”¨æˆ·ç¦»å¼€ç½‘ç«™åsessionä¼šè¢«é”€æ¯ã€‚è¿™ç§ç”¨æˆ·ä¿¡æ¯å­˜å‚¨æ–¹å¼ç›¸å¯¹cookieæ¥è¯´æ›´å®‰å…¨ï¼Œå¯æ˜¯sessionæœ‰ä¸€ä¸ªç¼ºé™·ï¼šå¦‚æœwebæœåŠ¡å™¨åšäº†è´Ÿè½½å‡è¡¡ï¼Œé‚£ä¹ˆä¸‹ä¸€ä¸ªæ“ä½œè¯·æ±‚åˆ°äº†å¦ä¸€å°æœåŠ¡å™¨çš„æ—¶å€™sessionä¼šä¸¢å¤±ã€‚</p>
<p><strong>sessionè¯·æ±‚è¿‡ç¨‹ï¼š</strong></p>
<ul>
<li><p>å®¢æˆ·ç«¯å‘æœåŠ¡å™¨è¯·æ±‚ï¼Œå‘é€ç”¨æˆ·åå’Œå¯†ç </p>
</li>
<li><p>æœåŠ¡å™¨ç”ŸæˆsessionIdï¼Œç»‘å®šç”¨æˆ·æ•°æ®å­˜å‚¨åœ¨æ•°æ®åº“</p>
</li>
<li><p>æœåŠ¡å™¨è¿”å›sessionIdç»™å®¢æˆ·ç«¯</p>
</li>
<li><p>å®¢æˆ·ç«¯å­˜å‚¨sessionIdï¼Œä»¥åçš„è¯·æ±‚éƒ½å¸¦ä¸Šè¿™ä¸ªsessionId</p>
</li>
<li><p>æœåŠ¡å™¨å¦‚æœæ”¶åˆ°è¿™ä¸ªsessionIdï¼Œé‚£ä¹ˆå°±å»æ•°æ®åº“æŸ¥æ‰¾ç”¨æˆ·æ•°æ®ï¼Œå¦‚æœæ‰¾åˆ°äº†è¯´æ˜éªŒè¯é€šè¿‡</p>
</li>
<li><p>æœåŠ¡å™¨æŠŠéªŒè¯ç»“æœè¿”å›å®¢æˆ·ç«¯</p>
</li>
</ul>
<p><img src="/2019/09/27/%E6%B5%85%E6%9E%90cookie-session-token/1.png" alt></p>
<blockquote>
<p>sessionå­˜åœ¨é—®é¢˜ï¼š</p>
<p>1ã€sessionä¿å­˜åœ¨æœåŠ¡ç«¯ï¼Œå½“å®¢æˆ·è®¿é—®é‡å¢åŠ æ—¶ï¼ŒæœåŠ¡ç«¯å°±éœ€è¦å­˜å‚¨å¤§é‡çš„sessionä¼šè¯ï¼Œå¯¹æœåŠ¡å™¨æœ‰å¾ˆå¤§çš„è€ƒéªŒï¼›<br>2ã€å½“æœåŠ¡ç«¯ä¸ºé›†ç¾¤æ—¶ï¼Œç”¨æˆ·ç™»é™†å…¶ä¸­ä¸€å°æœåŠ¡å™¨ï¼Œä¼šå°†sessionä¿å­˜åˆ°è¯¥æœåŠ¡å™¨çš„å†…å­˜ä¸­ï¼Œä½†æ˜¯å½“ç”¨æˆ·çš„è®¿é—®åˆ°å…¶ä»–æœåŠ¡å™¨æ—¶ï¼Œä¼šæ— æ³•è®¿é—®ï¼Œé€šå¸¸é‡‡ç”¨ç¼“å­˜ä¸€è‡´æ€§æŠ€æœ¯æ¥ä¿è¯å¯ä»¥å…±äº«ï¼Œæˆ–è€…é‡‡ç”¨ç¬¬ä¸‰æ–¹ç¼“å­˜æ¥ä¿å­˜sessionï¼Œä¸æ–¹ä¾¿ã€‚</p>
</blockquote>
<h5 id="å››ã€Token"><a href="#å››ã€Token" class="headerlink" title="å››ã€Token"></a>å››ã€Token</h5><p>â€‹            Tokenæ˜¯æœåŠ¡ç«¯ç”Ÿæˆçš„ä¸€ä¸²å­—ç¬¦ä¸²ï¼Œä»¥ä½œå®¢æˆ·ç«¯è¿›è¡Œè¯·æ±‚çš„ä¸€ä¸ªä»¤ç‰Œï¼Œå½“ç¬¬ä¸€æ¬¡ç™»å½•åï¼ŒæœåŠ¡å™¨ç”Ÿæˆä¸€ä¸ªTokenä¾¿å°†æ­¤Tokenè¿”å›ç»™å®¢æˆ·ç«¯ï¼Œä»¥åå®¢æˆ·ç«¯åªéœ€å¸¦ä¸Šè¿™ä¸ªTokenå‰æ¥è¯·æ±‚æ•°æ®å³å¯ï¼Œæ— éœ€å†æ¬¡å¸¦ä¸Šç”¨æˆ·åå’Œå¯†ç ã€‚</p>
<p>â€‹            Token çš„è®¤è¯æ–¹å¼ç±»ä¼¼äº<strong>ä¸´æ—¶çš„è¯ä¹¦ç­¾å</strong>, å¹¶ä¸”æ˜¯ä¸€ç§æœåŠ¡ç«¯æ— çŠ¶æ€çš„è®¤è¯æ–¹å¼, éå¸¸é€‚åˆäº REST API çš„åœºæ™¯. æ‰€è°“æ— çŠ¶æ€å°±æ˜¯æœåŠ¡ç«¯å¹¶ä¸ä¼šä¿å­˜èº«ä»½è®¤è¯ç›¸å…³çš„æ•°æ®ã€‚</p>
<p><strong>Tokenç»„æˆï¼š</strong></p>
<ul>
<li>uid: ç”¨æˆ·å”¯ä¸€èº«ä»½æ ‡è¯†</li>
<li>time: å½“å‰æ—¶é—´çš„æ—¶é—´æˆ³</li>
<li>sign: ç­¾å, ä½¿ç”¨ hash/encrypt å‹ç¼©æˆå®šé•¿çš„åå…­è¿›åˆ¶å­—ç¬¦ä¸²ï¼Œä»¥é˜²æ­¢ç¬¬ä¸‰æ–¹æ¶æ„æ‹¼æ¥</li>
<li>å›ºå®šå‚æ•°(å¯é€‰): å°†ä¸€äº›å¸¸ç”¨çš„å›ºå®šå‚æ•°åŠ å…¥åˆ° token ä¸­æ˜¯ä¸ºäº†é¿å…é‡å¤æŸ¥åº“</li>
</ul>
<p><strong>Toekenå­˜æ”¾ï¼š</strong></p>
<p>Tokenåœ¨å®¢æˆ·ç«¯ä¸€èˆ¬å­˜æ”¾äºlocalStorageï¼Œcookieï¼Œæˆ–sessionStorageä¸­ã€‚åœ¨æœåŠ¡å™¨ä¸€èˆ¬å­˜äºæ•°æ®åº“ä¸­.</p>
<p><strong>Tokenè¿‡ç¨‹:</strong><br>1ã€å®¢æˆ·ç«¯å‘æœåŠ¡å™¨è¯·æ±‚ï¼Œå‘é€ç”¨æˆ·åå’Œå¯†ç <br>2ã€æœåŠ¡å™¨æ ¹æ®ç”¨æˆ·ä¿¡æ¯é€šè¿‡åŠ å¯†ç”Ÿæˆtokenï¼Œç”¨æˆ·ä¿¡æ¯åŒ…æ‹¬è´¦å·ï¼Œtokenè¿‡æœŸæ—¶é—´ç­‰ï¼Œå…·ä½“ç”±æœåŠ¡å™¨è‡ªå®šä¹‰ã€‚<br>3ã€æœåŠ¡å™¨è¿”å›tokenç»™å®¢æˆ·ç«¯<br>4ã€å®¢æˆ·ç«¯ç”¨cookieå­˜å‚¨tokenï¼Œä»¥åçš„è¯·æ±‚éƒ½å¸¦ä¸Šè¿™ä¸ªtoken<br>5ã€æœåŠ¡å™¨æŠŠtokenè§£å¯†ï¼Œç¡®è®¤ç”¨æˆ·ä¿¡æ¯æ˜¯å¦æ­£ç¡®ï¼Œå¦‚ç»è¿‡æ­£ç¡®å°±è¯´æ˜éªŒè¯é€šè¿‡ã€‚<br>6ã€æœåŠ¡å™¨æŠŠéªŒè¯ç»“æœè¿”å›å®¢æˆ·ç«¯</p>
<p><img src="/2019/09/27/%E6%B5%85%E6%9E%90cookie-session-token/2.png" alt></p>
<h5 id="äº”ã€Cookieä¸sessionåŒºåˆ«ï¼š"><a href="#äº”ã€Cookieä¸sessionåŒºåˆ«ï¼š" class="headerlink" title="äº”ã€Cookieä¸sessionåŒºåˆ«ï¼š"></a>äº”ã€Cookieä¸sessionåŒºåˆ«ï¼š</h5><p>1ã€cookieæ•°æ®å­˜æ”¾åœ¨å®¢æˆ·çš„æµè§ˆå™¨ä¸Šï¼Œsessionæ•°æ®æ”¾åœ¨æœåŠ¡å™¨ä¸Šã€‚<br>2ã€cookieä¸æ˜¯å¾ˆå®‰å…¨ï¼Œåˆ«äººå¯ä»¥åˆ†æå­˜æ”¾åœ¨æœ¬åœ°çš„cookieå¹¶è¿›è¡Œcookieæ¬ºéª—,è€ƒè™‘åˆ°å®‰å…¨åº”å½“ä½¿ç”¨sessionã€‚</p>
<p>3ã€sessionä¼šåœ¨ä¸€å®šæ—¶é—´å†…ä¿å­˜åœ¨æœåŠ¡å™¨ä¸Šã€‚å½“è®¿é—®å¢å¤šï¼Œä¼šæ¯”è¾ƒå ç”¨ä½ æœåŠ¡å™¨çš„æ€§èƒ½,è€ƒè™‘åˆ°å‡è½»æœåŠ¡å™¨æ€§èƒ½æ–¹é¢ï¼Œåº”å½“ä½¿ç”¨cookieã€‚</p>
<p>4ã€å•ä¸ªcookieä¿å­˜çš„æ•°æ®ä¸èƒ½è¶…è¿‡4Kï¼Œå¾ˆå¤šæµè§ˆå™¨éƒ½é™åˆ¶ä¸€ä¸ªç«™ç‚¹æœ€å¤šä¿å­˜20ä¸ªcookieã€‚</p>
<h5 id="å…­ã€Tokenä¸sessionåŒºåˆ«"><a href="#å…­ã€Tokenä¸sessionåŒºåˆ«" class="headerlink" title="å…­ã€Tokenä¸sessionåŒºåˆ«"></a>å…­ã€Tokenä¸sessionåŒºåˆ«</h5><ol>
<li>tokenå°±æ˜¯ä»¤ç‰Œï¼Œæ¯”å¦‚ä½ æˆæƒï¼ˆç™»å½•ï¼‰ä¸€ä¸ªç¨‹åºæ—¶ï¼Œä»–å°±æ˜¯ä¸ªä¾æ®ï¼Œåˆ¤æ–­ä½ æ˜¯å¦å·²ç»æˆæƒè¯¥è½¯ä»¶ï¼ŒTokençš„çŠ¶æ€æ˜¯å­˜å‚¨åœ¨å®¢æˆ·ç«¯ã€‚</li>
<li>cookieå°±æ˜¯å†™åœ¨å®¢æˆ·ç«¯çš„ä¸€ä¸ªtxtæ–‡ä»¶ï¼Œé‡Œé¢åŒ…æ‹¬ä½ ç™»å½•ä¿¡æ¯ä¹‹ç±»çš„ï¼Œè¿™æ ·ä½ ä¸‹æ¬¡åœ¨ç™»å½•æŸä¸ªç½‘ç«™ï¼Œå°±ä¼šè‡ªåŠ¨è°ƒç”¨cookieè‡ªåŠ¨ç™»å½•ç”¨æˆ·åï¼›</li>
<li>sessionæ˜¯å†™åœ¨æœåŠ¡å™¨ç«¯çš„æ–‡ä»¶ï¼Œä¹Ÿéœ€è¦åœ¨å®¢æˆ·ç«¯å†™å…¥cookieæ–‡ä»¶ï¼Œä½†æ˜¯æ–‡ä»¶é‡Œæ˜¯ä½ çš„æµè§ˆå™¨ç¼–å·.Sessionçš„çŠ¶æ€æ˜¯å­˜å‚¨åœ¨æœåŠ¡å™¨ç«¯ï¼Œå®¢æˆ·ç«¯åªæœ‰session idï¼›</li>
</ol>
<h5 id="ä¸ƒã€å°ç»“"><a href="#ä¸ƒã€å°ç»“" class="headerlink" title="ä¸ƒã€å°ç»“"></a>ä¸ƒã€å°ç»“</h5><ol>
<li>sessionå­˜å‚¨äºæœåŠ¡å™¨ï¼Œå¯ä»¥ç†è§£ä¸ºä¸€ä¸ªçŠ¶æ€åˆ—è¡¨ï¼Œæ‹¥æœ‰ä¸€ä¸ªå”¯ä¸€è¯†åˆ«ç¬¦å·sessionIdï¼Œé€šå¸¸å­˜æ”¾äºcookieä¸­ã€‚æœåŠ¡å™¨æ”¶åˆ°cookieåè§£æå‡ºsessionIdï¼Œå†å»sessionåˆ—è¡¨ä¸­æŸ¥æ‰¾ï¼Œæ‰èƒ½æ‰¾åˆ°ç›¸åº”sessionã€‚ä¾èµ–cookie</li>
<li>cookieç±»ä¼¼ä¸€ä¸ªä»¤ç‰Œï¼Œè£…æœ‰sessionIdï¼Œå­˜å‚¨åœ¨å®¢æˆ·ç«¯ï¼Œæµè§ˆå™¨é€šå¸¸ä¼šè‡ªåŠ¨æ·»åŠ ã€‚</li>
<li>tokenä¹Ÿç±»ä¼¼ä¸€ä¸ªä»¤ç‰Œï¼Œæ— çŠ¶æ€ï¼Œç”¨æˆ·ä¿¡æ¯éƒ½è¢«åŠ å¯†åˆ°tokenä¸­ï¼ŒæœåŠ¡å™¨æ”¶åˆ°tokenåè§£å¯†å°±å¯çŸ¥é“æ˜¯å“ªä¸ªç”¨æˆ·ã€‚éœ€è¦å¼€å‘è€…æ‰‹åŠ¨æ·»åŠ ã€‚</li>
</ol>

      
    </div>

    
    
    
	<div>
		
	</div>
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/09/26/%E5%8D%9A%E5%AE%A2%E7%BC%96%E5%86%99%E6%AD%A5%E9%AA%A4/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/self.png">
      <meta itemprop="name" content="Anderson Wu">
      <meta itemprop="description" content="Love is love">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="é™ªä½ åº¦è¿‡æ¼«é•¿å²æœˆ">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/09/26/%E5%8D%9A%E5%AE%A2%E7%BC%96%E5%86%99%E6%AD%A5%E9%AA%A4/" class="post-title-link" itemprop="url">åšå®¢æ›´æ–°</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2019-09-26 20:02:19" itemprop="dateCreated datePublished" datetime="2019-09-26T20:02:19+08:00">2019-09-26</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2020-03-28 17:08:39" itemprop="dateModified" datetime="2020-03-28T17:08:39+08:00">2020-03-28</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/hexo/" itemprop="url" rel="index"><span itemprop="name">hexo</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h5 id="æ›´æ¢ç¯å¢ƒæ“ä½œ"><a href="#æ›´æ¢ç¯å¢ƒæ“ä½œ" class="headerlink" title="æ›´æ¢ç¯å¢ƒæ“ä½œ"></a>æ›´æ¢ç¯å¢ƒæ“ä½œ</h5><ul>
<li><p>git clone yourBlogAddresss.github.io.git æ‹·è´ä»“åº“ï¼›</p>
</li>
<li><p>åœ¨æœ¬åœ°yourBlogAddresss.github.io.gitæ–‡ä»¶å¤¹ä¸‹é€šè¿‡Git bashä¾æ¬¡æ‰§è¡Œ</p>
<ul>
<li>npm install </li>
<li>git add .</li>
<li>git commit -m â€˜xxxxâ€™</li>
<li>git push origin hexo</li>
<li>hexo  g -d</li>
</ul>
</li>
</ul>
<p>  å‚è€ƒï¼š</p>
<p>  <a href="https://www.zhihu.com/question/21193762" target="_blank" rel="noopener">https://www.zhihu.com/question/21193762</a></p>
<p>  <a href="https://www.jianshu.com/p/0b1fccce74e0" target="_blank" rel="noopener">https://www.jianshu.com/p/0b1fccce74e0</a></p>

      
    </div>

    
    
    
	<div>
		
	</div>
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/09/22/vue%E4%BD%BF%E7%94%A8prop%E6%95%B0%E6%8D%AE%E7%BB%91%E5%AE%9A%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/self.png">
      <meta itemprop="name" content="Anderson Wu">
      <meta itemprop="description" content="Love is love">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="é™ªä½ åº¦è¿‡æ¼«é•¿å²æœˆ">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/09/22/vue%E4%BD%BF%E7%94%A8prop%E6%95%B0%E6%8D%AE%E7%BB%91%E5%AE%9A%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9/" class="post-title-link" itemprop="url">vueä½¿ç”¨propsæ•°æ®ç»‘å®šå¼‚å¸¸</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2019-09-22 10:02:19" itemprop="dateCreated datePublished" datetime="2019-09-22T10:02:19+08:00">2019-09-22</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2020-03-28 17:07:31" itemprop="dateModified" datetime="2020-03-28T17:07:31+08:00">2020-03-28</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Vue/" itemprop="url" rel="index"><span itemprop="name">Vue</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h5 id="1-ä¸šåŠ¡åœºæ™¯"><a href="#1-ä¸šåŠ¡åœºæ™¯" class="headerlink" title="1.ä¸šåŠ¡åœºæ™¯"></a>1.ä¸šåŠ¡åœºæ™¯</h5><p>é€šè¿‡ç‚¹å‡»ä¿¡æ¯æ¡†ï¼Œè®¡ç®—ç‚¹å‡»çš„æ¬¡æ•°ã€‚ï¼ˆå•†å“ä¿¡æ¯ä¸ºä¸€ä¸ªç»„ä»¶ï¼‰</p>
<p><img src="/2019/09/22/vue%E4%BD%BF%E7%94%A8prop%E6%95%B0%E6%8D%AE%E7%BB%91%E5%AE%9A%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9/1.png" alt></p>
<p>å­ç»„ä»¶GlobalComponents.vue:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;div v-on:click=<span class="string">'increaseClcikTime'</span>&gt;clickTimes:&#123;&#123;<span class="keyword">this</span>.clickTime&#125;&#125;&lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">  &lt;/</span>div&gt;</span><br><span class="line">&lt;<span class="regexp">/template&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">&lt;script&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">export default &#123;</span></span><br><span class="line"><span class="regexp">  name: "GlobalComponents",</span></span><br><span class="line"><span class="regexp">  props:&#123;</span></span><br><span class="line"><span class="regexp">    name: String,</span></span><br><span class="line"><span class="regexp">    clickTime: String    </span></span><br><span class="line"><span class="regexp">  &#125;,</span></span><br><span class="line"><span class="regexp">  components: &#123;</span></span><br><span class="line"><span class="regexp">  &#125;,</span></span><br><span class="line"><span class="regexp">  methods: &#123;</span></span><br><span class="line"><span class="regexp">    increaseClcikTime: function()&#123;</span></span><br><span class="line"><span class="regexp">      this.clickTime ++</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">&#125;;</span></span><br><span class="line"><span class="regexp">&lt;/</span>script&gt;</span><br></pre></td></tr></table></figure>

<p>çˆ¶ç»„ä»¶ï¼š</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">GlobalComponents</span> <span class="attr">clickTime</span>=<span class="string">'10'</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<p>æ§åˆ¶å°æŠ¥é”™ï¼š</p>
<blockquote>
<p>vue.js?ba4c:634 [Vue warn]: Avoid mutating a prop directly since the value will be overwritten whenever the parent component re-renders. Instead, use a data or computed property based on the propâ€™s value. Prop being mutated: â€œclickTimeâ€</p>
</blockquote>
<h5 id="2-å•å‘æ•°æ®æµ"><a href="#2-å•å‘æ•°æ®æµ" class="headerlink" title="2.å•å‘æ•°æ®æµ"></a>2.å•å‘æ•°æ®æµ</h5><p>â€‹          props éƒ½ä½¿å¾—å…¶çˆ¶å­ ç»„ä»¶ä¹‹é—´å½¢æˆäº†ä¸€ä¸ª<strong>å•å‘ä¸‹è¡Œç»‘å®š</strong>ï¼šçˆ¶çº§ prop çš„æ›´æ–°ä¼šå‘ä¸‹æµåŠ¨åˆ°å­ç»„ä»¶ä¸­ï¼Œä½†æ˜¯åè¿‡æ¥åˆ™ä¸è¡Œã€‚è¿™æ ·ä¼šé˜²æ­¢ä»å­ç»„ä»¶æ„å¤–æ”¹å˜çˆ¶çº§ç»„ä»¶çš„çŠ¶æ€ï¼Œä»è€Œå¯¼è‡´ä½ çš„åº”ç”¨çš„æ•°æ®æµå‘éš¾ä»¥ç†è§£ã€‚</p>
<p>â€‹         æ¯æ¬¡çˆ¶çº§ç»„ä»¶å‘ç”Ÿæ›´æ–°æ—¶ï¼Œå­ç»„ä»¶ä¸­æ‰€æœ‰çš„ prop éƒ½å°†ä¼šåˆ·æ–°ä¸ºæœ€æ–°çš„å€¼ã€‚è¿™æ„å‘³ç€ä½ <strong>ä¸</strong>åº”è¯¥åœ¨ä¸€ä¸ªå­ç»„ä»¶å†…éƒ¨æ”¹å˜ propã€‚å¦‚æœä½ è¿™æ ·åšäº†ï¼ŒVue ä¼šåœ¨æµè§ˆå™¨çš„æ§åˆ¶å°ä¸­å‘å‡ºè­¦å‘Šã€‚</p>
<h5 id="3-è§£å†³æ–¹æ¡ˆ"><a href="#3-è§£å†³æ–¹æ¡ˆ" class="headerlink" title="3.è§£å†³æ–¹æ¡ˆ"></a>3.è§£å†³æ–¹æ¡ˆ</h5><p>  åœ¨å­ç»„ä»¶ä¸­å®šä¹‰ä¸€ä¸ªå˜é‡æ¥æ”¶propå€¼</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;div v-on:click=<span class="string">'increaseClcikTime'</span>&gt;clickTimes:&#123;&#123;<span class="keyword">this</span>.time&#125;&#125;&lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">  &lt;/</span>div&gt;</span><br><span class="line">&lt;<span class="regexp">/template&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">&lt;script&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">export default &#123;</span></span><br><span class="line"><span class="regexp">  name: "GlobalComponents",</span></span><br><span class="line"><span class="regexp">  props:&#123;</span></span><br><span class="line"><span class="regexp">    name: String,</span></span><br><span class="line"><span class="regexp">    clickTime: String    </span></span><br><span class="line"><span class="regexp">  &#125;,</span></span><br><span class="line"><span class="regexp">  components: &#123;</span></span><br><span class="line"><span class="regexp">  &#125;,</span></span><br><span class="line"><span class="regexp">  data()&#123;</span></span><br><span class="line"><span class="regexp">    return &#123;</span></span><br><span class="line"><span class="regexp">      time: Number(this.clickTime)</span></span><br><span class="line"><span class="regexp">    &#125;;</span></span><br><span class="line"><span class="regexp">  &#125;,</span></span><br><span class="line"><span class="regexp">  methods: &#123;</span></span><br><span class="line"><span class="regexp">    increaseClcikTime: function()&#123;</span></span><br><span class="line"><span class="regexp">      this.time ++</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">&#125;;</span></span><br><span class="line"><span class="regexp">&lt;/</span>script&gt;</span><br></pre></td></tr></table></figure>



<p><a href="https://www.jianshu.com/p/54cfaa2f5d5b" target="_blank" rel="noopener">å‚è€ƒèµ„æ–™</a></p>

      
    </div>

    
    
    
	<div>
		
	</div>
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/09/22/vue%E5%85%A8%E5%B1%80%E5%92%8C%E5%B1%80%E9%83%A8%E7%BB%84%E4%BB%B6%E6%B3%A8%E5%86%8C/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/self.png">
      <meta itemprop="name" content="Anderson Wu">
      <meta itemprop="description" content="Love is love">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="é™ªä½ åº¦è¿‡æ¼«é•¿å²æœˆ">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/09/22/vue%E5%85%A8%E5%B1%80%E5%92%8C%E5%B1%80%E9%83%A8%E7%BB%84%E4%BB%B6%E6%B3%A8%E5%86%8C/" class="post-title-link" itemprop="url">vueç»„ä»¶æ³¨å†Œ</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2019-09-22 10:02:19" itemprop="dateCreated datePublished" datetime="2019-09-22T10:02:19+08:00">2019-09-22</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2020-03-28 17:07:09" itemprop="dateModified" datetime="2020-03-28T17:07:09+08:00">2020-03-28</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Vue/" itemprop="url" rel="index"><span itemprop="name">Vue</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h5 id="1-ç»„ä»¶"><a href="#1-ç»„ä»¶" class="headerlink" title="1.ç»„ä»¶"></a>1.ç»„ä»¶</h5><p>â€‹         Vueä¸­çš„ç»„ä»¶æä¾›å¯å¤ç”¨çš„å®ä¾‹ï¼Œç»„ä»¶æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼ŒåŒ…å«data, computed, watch, methods, filtersä»¥åŠvueç»„ä»¶ç”Ÿå‘½å‘¨æœŸé’©å­ç­‰æˆå‘˜å±æ€§ã€‚</p>
<p>â€‹         å½“å‰ä½¿ç”¨çš„Vueç‰ˆæœ¬ï¼š3.11        </p>
<h5 id="2-ç»„ä»¶æ³¨å†Œ"><a href="#2-ç»„ä»¶æ³¨å†Œ" class="headerlink" title="2.ç»„ä»¶æ³¨å†Œ"></a>2.ç»„ä»¶æ³¨å†Œ</h5><p>å®šä¹‰ä¸€ä¸ªç»„ä»¶ï¼š</p>
<p>MyComponent.vue</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span>CustomerComponent----vue--------CustomerComponent<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line">  components: &#123;&#125;,</span><br><span class="line">  data() &#123;&#125;,</span><br><span class="line">  methods: &#123;&#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h6 id="2-1-å±€éƒ¨ç»„ä»¶"><a href="#2-1-å±€éƒ¨ç»„ä»¶" class="headerlink" title="2.1 å±€éƒ¨ç»„ä»¶"></a>2.1 å±€éƒ¨ç»„ä»¶</h6><p>ParentComponent.vue</p>
<ul>
<li>æ–¹å¼ä¸€ï¼š ç»„ä»¶å¼•å…¥å±€éƒ¨ç»„ä»¶</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">MyComponent</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript"><span class="keyword">import</span> MyComponent <span class="keyword">from</span> <span class="string">'./components/MyComponent.vue'</span>;</span></span><br><span class="line"><span class="javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line">  components: &#123;MyComponent&#125;, </span><br><span class="line">  data() &#123;&#125;,</span><br><span class="line">  methods: &#123;&#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>æ–¹å¼äºŒï¼šç»„ä»¶æ³¨å†Œå±€éƒ¨ç»„ä»¶:</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">child-component</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="actionscript"><span class="keyword">var</span> Child = &#123;</span></span><br><span class="line"><span class="handlebars"><span class="xml">  template: '<span class="tag">&lt;<span class="name">h1</span>&gt;</span>æˆ‘æ˜¯å±€éƒ¨ç»„ä»¶<span class="tag">&lt;/<span class="name">h1</span>&gt;</span>'</span></span></span><br><span class="line">&#125;</span><br><span class="line"><span class="javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="actionscript">  components: &#123; <span class="string">"child-component"</span>:child&#125;, </span></span><br><span class="line">  data() &#123;&#125;,</span><br><span class="line">  methods: &#123;&#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>â€‹            é€šè¿‡è¿™ç§æ–¹å¼æ³¨å†Œå±€éƒ¨ç»„ä»¶ï¼ŒæŠ¥é”™ï¼šYou are using the runtime-only build of Vue where the template compiler is not available. Either pre-compile the templates into render functions, or use the compiler-included build.</p>
<p>Vueé¡¹ç›®è¿è¡Œç¯å¢ƒé…ç½®æœ‰ä¸¤ç§ç‰ˆæœ¬ï¼šCompilerå’ŒRuntimeã€‚ä¸¤è€…çš„åŒºåˆ«ï¼š</p>
<ul>
<li>å½“å¯¹templateæ¨¡æ¿å†…å®¹ç¼–è¯‘æ˜¯éœ€è¦å¯¹å­—ç¬¦ä¸²è¿›è¡Œæ¨¡æ¿æ¸²æŸ“æˆ–è€…å¯ä»¥ç»‘å®šçš„htmlå¯¹è±¡ä½œä¸ºæ¨¡æ¿è¿›è¡Œæ¸²æŸ“çš„æ–¹å¼ï¼Œå°±éœ€è¦ä½¿ç”¨Compilerç‰ˆæœ¬ã€‚</li>
<li>å¦‚æœä½¿ç”¨vue-loaderåŠ è½½.vueæ–‡ä»¶æ—¶ï¼ˆç»„ä»¶æ–‡ä»¶ï¼‰ï¼Œwebpackåœ¨æ‰“åŒ…å¯¹æ¨¡æ¿è¿›è¡Œäº†æ¸²æŸ“ï¼Œå°±éœ€è¦Runtimeç‰ˆæœ¬ã€‚</li>
</ul>
<p><strong>è§£å†³æ–¹æ¡ˆï¼š</strong></p>
<ul>
<li>å¯ä»¥é€šè¿‡åœ¨<strong>webpack.config.js</strong>æ–‡ä»¶ä¸­æ·»åŠ </li>
</ul>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">resolve: &#123; alias: &#123; vue: 'vue/dist/vue.js' &#125; &#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><p>å¼•ç”¨vueæ—¶ï¼Œç›´æ¥å†™æˆå¦‚ä¸‹å³å¯</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">'vue/dist/vue.js'</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<p>ä»¥ä¸Šä¸¤ç§æ–¹æ³•éƒ½æ˜¯é€šè¿‡å¼•å…¥vue.esm.jsæ–‡ä»¶ä½œä¸ºvueå¯¹è±¡ï¼Œé…ç½®æˆ compilerè¿è¡Œæ¨¡å¼ã€‚</p>
<p>â€‹          å…¶å®ï¼ŒVue æœ€æ—©ä¼šæ‰“åŒ…ç”Ÿæˆä¸‰ä¸ªæ–‡ä»¶ï¼Œä¸€ä¸ªæ˜¯ runtime only çš„æ–‡ä»¶ vue.common.jsï¼Œä¸€ä¸ªæ˜¯ compiler only çš„æ–‡ä»¶ compiler.jsï¼Œä¸€ä¸ªæ˜¯ runtime + compiler çš„æ–‡ä»¶ vue.jsã€‚</p>
<p>â€‹            è€Œ<strong>vue.js = vue.common.js + compiler.js</strong>ï¼Œè€Œå¦‚æœè¦ä½¿ç”¨ <strong>template</strong> è¿™ä¸ªå±æ€§çš„è¯å°±ä¸€å®šè¦ç”¨ <strong>compiler.js</strong>ï¼Œé‚£ä¹ˆï¼Œå¼•å…¥ <strong>vue.js</strong> æ˜¯æœ€æ°å½“çš„ã€‚</p>
<p>â€‹            vueæ¨¡å—çš„package.jsonçš„mainå­—æ®µé»˜è®¤ä¸ºruntimeæ¨¡å¼ï¼Œ æŒ‡å‘äº†â€dist/vue.runtime.common.jsâ€ä½ç½®ã€‚å› æ­¤åœ¨ç»„ä»¶ä¸­æ³¨å†Œå±€éƒ¨ç»„ä»¶ï¼Œéœ€è¦å¯¹templateæ¨¡æ¿å†…å®¹æ—¶ï¼Œåº”è¯¥å¼•å…¥<strong>vue/dist/vue.js</strong></p>
<p><a href="https://jiongks.name/blog/code-review-for-vue-next/" target="_blank" rel="noopener">å‚è€ƒæ•™ç¨‹</a></p>
<p>æ³¨æ„ï¼š<strong>å±€éƒ¨æ³¨å†Œçš„ç»„ä»¶åœ¨å…¶å­ç»„ä»¶ä¸­ä¸å¯ç”¨</strong> </p>
<h6 id="2-2å…¨å±€ç»„ä»¶"><a href="#2-2å…¨å±€ç»„ä»¶" class="headerlink" title="2.2å…¨å±€ç»„ä»¶"></a>2.2å…¨å±€ç»„ä»¶</h6><p>å…¨å±€ç»„ä»¶éœ€è¦åœ¨é¡¹ç›®çš„main.jsä¸­è¿›è¡Œæ³¨å†Œï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> CustPor <span class="keyword">from</span> <span class="string">'./components/MyComponent.vue'</span></span><br><span class="line"></span><br><span class="line">Vue.component(<span class="string">'GlobalComponents'</span>,CustPor)</span><br></pre></td></tr></table></figure>

<p>ç„¶ååœ¨ä»»æ„å…¶ä»–ç»„ä»¶éƒ½ä½¿ç”¨è¯¥å…¨å±€ç»„ä»¶ï¼Œä¸éœ€è¦åœ¨vueå®ä¾‹é€‰é¡¹componentsä¸Šåœ¨æ¬¡å®šä¹‰ï¼Œä¹Ÿä¸éœ€è¦å†æ¬¡å¯¼å…¥æ–‡ä»¶è·¯å¾„ï¼š</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">GlobalComponents</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<p>ç›¸å…³å‚è€ƒï¼š</p>
<p><a href="https://segmentfault.com/a/1190000011465462" target="_blank" rel="noopener">https://segmentfault.com/a/1190000011465462</a></p>
<p><a href="https://www.php.cn/js-tutorial-403100.html" target="_blank" rel="noopener">https://www.php.cn/js-tutorial-403100.html</a></p>

      
    </div>

    
    
    
	<div>
		
	</div>
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/09/15/vue%E8%87%AA%E5%AE%9A%E4%B9%89%E6%8C%87%E4%BB%A4/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/self.png">
      <meta itemprop="name" content="Anderson Wu">
      <meta itemprop="description" content="Love is love">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="é™ªä½ åº¦è¿‡æ¼«é•¿å²æœˆ">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/09/15/vue%E8%87%AA%E5%AE%9A%E4%B9%89%E6%8C%87%E4%BB%A4/" class="post-title-link" itemprop="url">vueè‡ªå®šä¹‰æŒ‡ä»¤</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2019-09-15 20:02:19" itemprop="dateCreated datePublished" datetime="2019-09-15T20:02:19+08:00">2019-09-15</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2020-03-28 17:08:17" itemprop="dateModified" datetime="2020-03-28T17:08:17+08:00">2020-03-28</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Vue/" itemprop="url" rel="index"><span itemprop="name">Vue</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h5 id="1-èƒŒæ™¯ï¼š"><a href="#1-èƒŒæ™¯ï¼š" class="headerlink" title="1.èƒŒæ™¯ï¼š"></a>1.èƒŒæ™¯ï¼š</h5><p>â€‹         è¿™å‘¨å·®ä¸å¤šä¸€å‘¨æ²¡æœ‰æ­£å¼å†™ä»£ç ï¼Œæˆä¸ºä¸€åâ€œæ•°æ®åˆ†æå¸ˆâ€ï¼Œå›æƒ³èµ·ä¹‹å‰å­¦ä¹ çš„å‰ç«¯æ¡†æ¶vueï¼Œæˆ‘å¥½åƒå¯¹vueçš„è‡ªå®šä¹‰æŒ‡å®šä¸ç†Ÿæ‚‰ï¼Œå†³å®šå­¦ä¹ è¿™ä¸€éƒ¨åˆ†å†…å®¹ã€‚</p>
<h5 id="2-å¸¸ç”¨æŒ‡ä»¤"><a href="#2-å¸¸ç”¨æŒ‡ä»¤" class="headerlink" title="2.å¸¸ç”¨æŒ‡ä»¤"></a>2.å¸¸ç”¨æŒ‡ä»¤</h5><p>â€‹        vueæœ‰å¾ˆå¤šå¸¸ç”¨æŒ‡ä»¤ï¼Œæ¯”å¦‚v-onæ·»åŠ ç›‘å¬äº‹ä»¶ï¼Œv-bindåšå±æ€§ç»‘å®šï¼Œv-ifè¿›è¡Œæ§åˆ¶åˆ‡æ¢ä¸€ä¸ªå…ƒç´ æ˜¯å¦æ˜¾ç¤ºï¼Œv-foræŒ‡ä»¤å¯ä»¥ç»‘å®šæ•°ç»„çš„æ•°æ®æ¥æ¸²æŸ“ä¸€ä¸ªé¡¹ç›®åˆ—è¡¨ã€‚</p>
<h5 id="3-è‡ªå®šä¹‰æŒ‡ä»¤"><a href="#3-è‡ªå®šä¹‰æŒ‡ä»¤" class="headerlink" title="3.è‡ªå®šä¹‰æŒ‡ä»¤"></a>3.è‡ªå®šä¹‰æŒ‡ä»¤</h5><p>â€‹        åˆ©ç”¨ä¹‹å‰ThoughtWorksè€å¸ˆæ•™çš„â€œéœ€æ±‚é©±åŠ¨å­¦ä¹ æ³•â€ï¼Œé¦–å…ˆç¡®å®šä¸€ä¸ªå°éœ€æ±‚ï¼šç»™æ–‡å­—æ·»åŠ ç²‰çº¢è‰²ã€‚å½“ç„¶ï¼Œç›´æ¥æ·»åŠ æ ·å¼å°±å¯ä»¥å®ç°è¯¥éœ€æ±‚ï¼Œä½†ä½¿ç”¨è‡ªå®šä¹‰æŒ‡ä»¤åŒæ ·å¯ä»¥ã€‚</p>
<p>è‡ªå®šä¹‰å±æ€§å®ç°è¯¥éœ€æ±‚æ­¥éª¤ï¼š</p>
<ul>
<li>ä½¿ç”¨Vue.directive æ³¨å†Œä¸€ä¸ªå…¨å±€è‡ªå®šä¹‰æŒ‡ä»¤</li>
<li>ç¬¬ä¸€ä¸ªå‚æ•°å°±æ˜¯ æŒ‡ä»¤åç§° pink</li>
<li>el è¡¨ç¤ºå½“å‰çš„html domå¯¹è±¡</li>
<li>åœ¨æ–¹æ³•ä½“å†…å¯ä»¥é€šè¿‡ innerHTML style.color æ“æ§å½“å‰å…ƒç´ ï¼Œæ·»åŠ æ ·å¼ã€‚</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Vue.directive(<span class="string">'pink'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">el</span>) </span>&#123;</span><br><span class="line">	el.innerHTML = el.innerHTML + <span class="string">' ( x-pink ) '</span></span><br><span class="line">	el.style.color = <span class="string">'pink'</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>æºä»£ç ä¸ºï¼š</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"http://how2j.cn/study/vue.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"div1"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">v-pink</span>&gt;</span> å¥½å¥½å­¦ä¹ ï¼Œå¤©å¤©å‘ä¸Š <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="actionscript">Vue.directive(<span class="string">'pink'</span>, <span class="function"><span class="keyword">function</span> <span class="params">(el)</span> </span>&#123;</span></span><br><span class="line"><span class="actionscript">    el.innerHTML = el.innerHTML + <span class="string">' ( ä½¿ç”¨è‡ªå®šä¹‰æŒ‡ä»¤x-pink ) '</span></span></span><br><span class="line"><span class="actionscript">    el.style.color = <span class="string">'pink'</span></span></span><br><span class="line">    el.font-weight:bold</span><br><span class="line">&#125;)</span><br><span class="line"> </span><br><span class="line"><span class="actionscript"><span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="actionscript">  el: <span class="string">'#div1'</span></span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>æ•ˆæœï¼š</p>
<p><img src="/2019/09/15/vue%E8%87%AA%E5%AE%9A%E4%B9%89%E6%8C%87%E4%BB%A4/define1.PNG" alt></p>
<h5 id="4-å¸¦å‚æ•°çš„è‡ªå®šä¹‰æŒ‡ä»¤"><a href="#4-å¸¦å‚æ•°çš„è‡ªå®šä¹‰æŒ‡ä»¤" class="headerlink" title="4.å¸¦å‚æ•°çš„è‡ªå®šä¹‰æŒ‡ä»¤"></a>4.å¸¦å‚æ•°çš„è‡ªå®šä¹‰æŒ‡ä»¤</h5><p>â€‹        è‡ªå®šä¹‰æŒ‡ä»¤å¯ä»¥è·å–è§†å›¾ä¸­çš„jsonå¯¹è±¡çš„å€¼ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Vue.directive(<span class="string">'xart'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">el,binding</span>) </span>&#123;</span><br><span class="line">	el.innerHTML = el.innerHTML + <span class="string">'( '</span> + binding.value.text + <span class="string">' )'</span></span><br><span class="line">	el.style.color = binding.value.color</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">v-xart</span>=<span class="string">"&#123;color:'red',text:'best learning video'&#125;"</span>&gt;</span> å¥½å¥½å­¦ä¹ ï¼Œå¤©å¤©å‘ä¸Š <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>â€‹        xartä¸ºè‡ªå®šä¹‰æŒ‡ä»¤çš„åç§°ï¼Œelä¸ºDomå¯¹è±¡ï¼Œbinding.value æŒ‡ä»¤ä¸­çš„jsonå¯¹è±¡ï¼Œå¯ä»¥é€šè¿‡ .color æˆ– .text è·å–å¯¹åº”çš„å€¼ã€‚</p>
<p>æºä»£ç ï¼š</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"http://how2j.cn/study/vue.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"div1"</span>&gt;</span></span><br><span class="line">     </span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">v-xart</span>=<span class="string">"&#123;color:'red',text:'best learning video'&#125;"</span>&gt;</span> å¥½å¥½å­¦ä¹ ï¼Œå¤©å¤©å‘ä¸Š <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">     </span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="actionscript">Vue.directive(<span class="string">'xart'</span>, <span class="function"><span class="keyword">function</span> <span class="params">(el,binding)</span> </span>&#123;</span></span><br><span class="line"><span class="actionscript">    el.innerHTML = el.innerHTML + <span class="string">'( '</span> + binding.value.text + <span class="string">' )'</span></span></span><br><span class="line">    el.style.color = binding.value.color</span><br><span class="line">&#125;)</span><br><span class="line"> </span><br><span class="line"><span class="actionscript"><span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="actionscript">  el: <span class="string">'#div1'</span></span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>æ•ˆæœï¼š</p>
<p><img src="/2019/09/15/vue%E8%87%AA%E5%AE%9A%E4%B9%89%E6%8C%87%E4%BB%A4/define2.PNG" alt></p>

      
    </div>

    
    
    
	<div>
		
	</div>
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/09/08/Toplink/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/self.png">
      <meta itemprop="name" content="Anderson Wu">
      <meta itemprop="description" content="Love is love">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="é™ªä½ åº¦è¿‡æ¼«é•¿å²æœˆ">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/09/08/Toplink/" class="post-title-link" itemprop="url">TopLinkå’ŒHibernateåŒºåˆ«</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2019-09-08 20:02:19" itemprop="dateCreated datePublished" datetime="2019-09-08T20:02:19+08:00">2019-09-08</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2020-03-28 17:06:53" itemprop="dateModified" datetime="2020-03-28T17:06:53+08:00">2020-03-28</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Oracle/" itemprop="url" rel="index"><span itemprop="name">Oracle</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h5 id="1-èƒŒæ™¯ï¼š"><a href="#1-èƒŒæ™¯ï¼š" class="headerlink" title="1.èƒŒæ™¯ï¼š"></a>1.èƒŒæ™¯ï¼š</h5><p>â€‹        è¿‘æœŸå¼€å‘çš„SIé¡¹ç›®ä¸­ï¼Œä½¿ç”¨çš„æ˜¯TopLinkæŒä¹…åŒ–æ¡†æ¶ï¼Œå°†å¯¹è±¡å…³ç³»æ˜ å°„åˆ°oracleè¡¨ã€‚ä½†æ˜¯å½“æˆ‘ä»¬å‡†å¤‡å°†æ•°æ®ç»“æ„å¤æ‚çš„è¡¨å•æäº¤åˆ°åå°æ—¶ï¼Œæˆ‘ä»¬å‘ç°å½“ç±»å±æ€§æ˜¯ä¸€ä¸ªæ¥å£ç±»å‹ï¼Œåœ¨ç±»çš„æ„é€ å‡½æ•°ä¸­ï¼Œç”¨æ¥å£çš„å®ç°ç±»èµ‹å€¼ç»™è¯¥å±æ€§ï¼Œè€Œå®ç°ç±»ä¸­åŒ…å«äº†ä¸€ä¸ªObjectå±æ€§ï¼Œç”¨setæ–¹æ³•èµ‹å€¼å…·ä½“çš„æ•°æ®ç±»ï¼ŒTopLinkæ€»æ˜¯æ— æ³•æ˜ å°„è¯¥æ•°æ®ç±»åˆ°æŒ‡å®šè¡¨ä¸­ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ShippingInstructionBase</span></span>&#123;</span><br><span class="line">   <span class="keyword">private</span> ValueHolderInterface route;</span><br><span class="line">    </span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="title">ShippingInstructionBase</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.route = <span class="keyword">new</span> ValueHolder();</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="function"><span class="keyword">public</span> ShippingInstructionRoute <span class="title">getRoute</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    	<span class="keyword">return</span> (ShippingInstructionRoute) <span class="keyword">this</span>.route.getValue();</span><br><span class="line">   &#125; </span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setRoute</span><span class="params">(ShippingInstructionRoute route)</span> </span>&#123;</span><br><span class="line">    	<span class="keyword">this</span>.route.setValue(route);</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">ValueHolderInterface</span> </span>&#123;</span><br><span class="line">    <span class="function">Object <span class="title">getValue</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">setValue</span><span class="params">(Object var1)</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ValueHolder</span> <span class="keyword">implements</span> <span class="title">ValueHolderInterface</span></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> Object value;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ValueHolder</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ValueHolder</span><span class="params">(Object var1)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.value = var1;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">synchronized</span> Object <span class="title">getValue</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.value;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setValue</span><span class="params">(Object var1)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.value = var1;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>â€‹        é—®é¢˜ï¼šæ•°æ®ç±»ShippingInstructionRouteæ— æ³•æ˜ å°„æˆè¡¨æ•°æ®ã€‚</p>
<h5 id="2-å…³äºToplink"><a href="#2-å…³äºToplink" class="headerlink" title="2.å…³äºToplink"></a>2.å…³äºToplink</h5><p>â€‹        TopLinkæ˜¯Oracleæ——ä¸‹ä¼˜ç§€çš„å¯¹è±¡å…³ç³»æ˜ å°„æŒä¹…å±‚è§£å†³æ–¹æ¡ˆï¼ŒTopLinkæ€§èƒ½ä¼˜å¼‚ï¼ŒåŠŸèƒ½å¼ºå¤§ï¼Œå¹¶ä¸”æä¾›äº†ç‹¬ç‰¹çš„æŸ¥è¯¢è¿‡æ»¤å™¨æœºåˆ¶ï¼Œä»¥åŠå¯¹å…³ç³»çš„å¤„ç†å’ŒæŸ¥è¯¢ã€‚æœ€å¤§çš„å…³ç³»æ•°æ®åº“å‚å•†Oracleå°†å…¶æ”¶è´­ï¼Œå‘å±•æˆå¼ºå¤§çš„å¯¹è±¡æ˜ å°„ä¸­é—´ä»¶ï¼Œä½†æ˜¯æœ€åˆTopLinkå¹¶æœªå¼€æºï¼Œè€Œå¦å¤–ä»¥ä¸€ç§å¼€æºçš„O/R Mappingæ¡†æ¶å‡­å€Ÿç€å¼ºå¤§çš„åŠŸèƒ½ï¼ŒJavaåå°„APIè¿›è¡Œå¯¹è±¡çš„æ˜ å°„ï¼Œå’Œæ–¹ä¾¿çš„å…³ç³»æŸ¥è¯¢ï¼Œæˆä¸ºä¸»æµçš„JPAå®ç°æ–¹å¼ã€‚</p>
<h5 id="3-Hibernate-JPAå’ŒToplink-JPA"><a href="#3-Hibernate-JPAå’ŒToplink-JPA" class="headerlink" title="3.Hibernate JPAå’ŒToplink JPA"></a>3.Hibernate JPAå’ŒToplink JPA</h5><p>â€‹         æ¯”è¾ƒä¸¤è€…åŒºåˆ«é¦–å…ˆéœ€è¦äº†è§£JPAï¼š</p>
<p>â€‹        JPA(Java Persistence API)æ˜¯Sunçš„å®˜æ–¹JavaæŒä¹…æ€§è§„èŒƒã€‚å®ƒä¸ºJavaå¼€å‘äººå‘˜æä¾›äº†ä¸€ä¸ªå¯¹è±¡/å…³ç³»æ˜ å°„å·¥å…·æ¥ç®¡ç†Javaåº”ç”¨ç¨‹åºä¸­çš„å…³ç³»æ•°æ®ã€‚</p>
<p>â€‹         JPAå…·æœ‰ä»¥ä¸‹ä¸‰ç§ç‰¹ç‚¹:</p>
<ul>
<li><p>ORMæ˜ å°„æˆå…ƒæ•°æ®</p>
<p>JPAæ”¯æŒXMLå’ŒJDK5.0æ³¨é‡Šä¸¤ç§å…ƒæ•°æ®ï¼ˆæè¿°å¯¹è±¡å’Œè¡¨ä¹‹é—´çš„æ˜ å°„å…³ç³»ï¼‰å½¢å¼ï¼Œå°†å®ä½“ç±»å¯¹è±¡æŒä¹…åŒ–åˆ°æ•°æ®åº“è¡¨ä¸­ã€‚</p>
</li>
<li><p>JavaæŒä¹…åŒ–API</p>
<p>JPAå®ç°äº†å¯¹å®ä½“å¯¹è±¡æ‰§è¡ŒCRUDæ“ä½œï¼Œå¼€å‘è€…å¯ä»¥å‡å°‘é‡å¤ç¹ççš„JDBCå’ŒSQLã€‚</p>
</li>
<li><p>æŸ¥è¯¢è¯­è¨€</p>
<p>JPAæ”¯æŒé€šè¿‡é¢å‘å¯¹è±¡çš„æŸ¥è¯¢æ–¹å¼ï¼ŒæŸ¥è¯¢æ•°æ®ï¼Œä»è€Œé¿å…ç¨‹åºçš„SQLè¯­å¥ç´§å¯†è€¦åˆã€‚</p>
</li>
</ul>
<p>å…³äºHibernate JPAå’ŒToplink JPAçš„æ¯”è¾ƒåšå®¢ï¼Œèƒ½æ‰¾çš„èµ„æ–™ä¸å¤šï¼Œå¯èƒ½æ˜¯ç”±äºTopLinkå¼€æºä»¥æ¥å¹¶æ²¡æœ‰å¹¿æ³›çš„æ¨å¹¿ï¼Œå…·ä½“çš„æ¯”è¾ƒå¦‚ä¸‹ï¼š</p>
<p><img src="/2019/09/08/Toplink/compare1.PNG" alt></p>
<p><img src="/2019/09/08/Toplink/compare2PNG.PNG" alt></p>
<p><a href="https://www.jumpingbean.co.za/blogs/mark/hibernate-toplink-jpa-differences" target="_blank" rel="noopener">å‚è€ƒèµ„æ–™</a></p>
<h5 id="4-å“ªä¸ªæ›´ä¼˜ç§€ï¼Ÿ"><a href="#4-å“ªä¸ªæ›´ä¼˜ç§€ï¼Ÿ" class="headerlink" title="4.å“ªä¸ªæ›´ä¼˜ç§€ï¼Ÿ"></a>4.å“ªä¸ªæ›´ä¼˜ç§€ï¼Ÿ</h5><p>å…³äºä¸¤è€…ä¼˜åŠ£ï¼Œä¸€ç›´æ˜¯ä¼—è¯´çº·çº­ï¼Œä»¥ä¸‹ä¸ºä¸€ç¯‡æ–‡ç« ä¸­çš„æ€»ç»“ï¼š</p>
<figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">TopLink <span class="keyword">is</span> fast, nimbly maps complex relationships, <span class="keyword">and</span> provides both EJB-<span class="keyword">like</span> <span class="keyword">and</span> nearly transparent Java models. But Oracle recently acquired TopLink, <span class="keyword">and</span> Oracle <span class="keyword">is</span> regrettably both a database vendor <span class="keyword">and</span> an application server vendor. </span><br><span class="line"><span class="keyword">If</span> you<span class="comment">'re a WebLogic customer or use a non-Oracle database, you're going to want to think long and hard before buying TopLink. It's still a great product for pure Oracle customers, but others simply must protect themselves against a potential change in direction of TopLink. Of course, you may choose to buy another proprietary OR mapper instead. </span></span><br><span class="line">The problem <span class="keyword">is</span> that you<span class="comment">'d then be buying a proprietary product with less-than-compelling market share. You'd have to pay more for training, experienced developers, and aftermarket tools. While TopLink has been king for a day, many customers will want to look away from the proprietary relational mappers</span></span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Hibernate is the open-source darling</span><br><span class="line">	If you're looking for a good persistence framework and you like open-source software, you owe it to yourself to <span class="keyword">check</span> <span class="keyword">out</span> Hibernate. It<span class="string">'s a lightweight persistence framework that'</span>s gathered quite a following. <span class="keyword">Like</span> JDO, it works well <span class="keyword">with</span> WebLogic, <span class="keyword">with</span> <span class="keyword">or</span> <span class="keyword">without</span> EJB. It has several fundamental strengths:</span><br><span class="line">- Hibernate uses <span class="keyword">Java</span> reflection instead <span class="keyword">of</span> <span class="keyword">byte</span> code enhancement <span class="keyword">to</span> achieve transparency.</span><br><span class="line"></span><br><span class="line">- Hibernate <span class="keyword">performance</span> <span class="keyword">is</span> surprisingly good because it <span class="keyword">is</span> such a lightweight framework.</span><br><span class="line"></span><br><span class="line">- The <span class="keyword">mapping</span> flexibility <span class="keyword">is</span> outstanding. It has good support <span class="keyword">for</span> several <span class="keyword">relational</span> </span><br><span class="line"><span class="keyword">databases</span>, <span class="keyword">with</span> complex relationships ranging <span class="keyword">from</span> one-<span class="keyword">to</span>-one <span class="keyword">to</span> many-<span class="keyword">to</span>-many.</span><br><span class="line">	Hibernate too has <span class="keyword">some</span> disadvantages. It puts <span class="keyword">some</span> limitations <span class="keyword">on</span> your <span class="keyword">object</span> model. (<span class="keyword">For</span> example, one persistent <span class="keyword">class</span> cannot <span class="keyword">map</span> <span class="keyword">to</span> more <span class="keyword">than</span> one table.) The combination <span class="keyword">of</span> a proprietary <span class="keyword">interface</span> <span class="keyword">and</span> smaller market <span class="keyword">share</span> <span class="keyword">is</span> also disconcerting, but Hibernate seems <span class="keyword">to</span> have mitigated that risk <span class="keyword">by</span> establishing good momentum. Other <span class="keyword">open</span>-<span class="keyword">source</span> persistence frameworks exist <span class="keyword">as</span> well, but <span class="keyword">none</span> <span class="keyword">with</span> the momentum <span class="keyword">of</span> Hibernate.</span><br></pre></td></tr></table></figure>

<p>â€‹            æ€»çš„æ¥è¯´ï¼Œåœ¨TopLinkå¼€æºå‰ï¼ŒHibernateå‡­å€Ÿå…¶è½»é‡çº§å’Œæ˜ å°„çš„çµæ´»æ€§ï¼Œè€Œæ›´åŠ å¹¿æ³›ä½¿ç”¨ï¼Œè€ŒTopLinkå¼€æºåï¼Œå’ŒOracleæ•°æ®åº“ç›¸ç»“åˆï¼Œæ€§èƒ½æ›´åŠ ä¼˜è¶Šã€‚</p>
<p><strong>ç›¸å…³ï¼š</strong><a href="https://blog.csdn.net/zcy860511/article/details/38521595" target="_blank" rel="noopener">å…³äºHibernateå’ŒTopLinkåœ¨æ’å…¥å’ŒæŸ¥è¯¢æ•°æ®ä¸Šçš„æ€§èƒ½æ¯”è¾ƒ</a></p>

      
    </div>

    
    
    
	<div>
		
	</div>
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/09/01/event/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/self.png">
      <meta itemprop="name" content="Anderson Wu">
      <meta itemprop="description" content="Love is love">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="é™ªä½ åº¦è¿‡æ¼«é•¿å²æœˆ">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/09/01/event/" class="post-title-link" itemprop="url">è¡¨å•è„šæœ¬</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2019-09-01 19:37:58" itemprop="dateCreated datePublished" datetime="2019-09-01T19:37:58+08:00">2019-09-01</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2020-03-28 17:04:04" itemprop="dateModified" datetime="2020-03-28T17:04:04+08:00">2020-03-28</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h5 id="ä¸€ã€è¡¨å•"><a href="#ä¸€ã€è¡¨å•" class="headerlink" title="ä¸€ã€è¡¨å•"></a>ä¸€ã€è¡¨å•</h5><p>ä¸€ä¸ªè¡¨å•ä¸»è¦æœ‰ä¸‰éƒ¨åˆ†ç»„æˆï¼š</p>
<ul>
<li>è¡¨å•æ ‡ç­¾ï¼šè¿™é‡Œé¢åŒ…å«äº†å¤„ç†è¡¨å•æ•°æ®æ‰€ç”¨CGIç¨‹åºçš„URLä»¥åŠæ•°æ®æäº¤åˆ°æœåŠ¡å™¨çš„æ–¹æ³•ã€‚ </li>
<li>è¡¨å•åŸŸï¼šåŒ…å«äº†æ–‡æœ¬æ¡†ã€å¯†ç æ¡†ã€éšè—åŸŸã€å¤šè¡Œæ–‡æœ¬æ¡†ã€å¤é€‰æ¡†ã€å•é€‰æ¡†ã€ä¸‹æ‹‰é€‰æ‹©æ¡†å’Œæ–‡ä»¶ä¸Šä¼ æ¡†ç­‰ã€‚ </li>
<li>è¡¨å•æŒ‰é’®ï¼šåŒ…æ‹¬æäº¤æŒ‰é’®ã€å¤ä½æŒ‰é’®å’Œä¸€èˆ¬æŒ‰é’®ï¼›ç”¨äºå°†æ•°æ®ä¼ é€åˆ°æœåŠ¡å™¨ä¸Šçš„CGIè„šæœ¬æˆ–è€…å–æ¶ˆè¾“å…¥ï¼Œè¿˜å¯ä»¥ç”¨è¡¨å•æŒ‰é’®æ¥æ§åˆ¶å…¶ä»–å®šä¹‰äº†å¤„ç†è„šæœ¬çš„å¤„ç†å·¥ä½œã€‚</li>
</ul>
<p>â€‹        HTML è¡¨å•ç”¨äºæœé›†ä¸åŒç±»å‹çš„ç”¨æˆ·è¾“å…¥ã€‚å¯ä»¥ä½¿ç”¨<code>&lt;form&gt;</code> å…ƒç´ æ¥å®šä¹‰ã€‚åœ¨ JavaScript ä¸­ï¼Œè¡¨å•å¯¹åº”çš„æ˜¯ HTMLFormElement ç±»å‹ã€‚ HTMLFormElement ç»§æ‰¿äº† HTMLElement ï¼Œå› è€Œä¸å…¶ä»– HTML å…ƒç´ å…·æœ‰ç›¸åŒçš„é»˜è®¤å±æ€§ã€‚æ­¤å¤–ï¼ŒHTMLFormElement è¿˜å…·æœ‰ç‹¬ç‰¹çš„å±æ€§å’Œæ–¹æ³•ã€‚</p>
<blockquote>
<ul>
<li>acceptCharset ï¼šæœåŠ¡å™¨èƒ½å¤Ÿå¤„ç†çš„å­—ç¬¦é›†ï¼›ç­‰ä»·äº HTML ä¸­çš„ accept-charset ç‰¹æ€§ã€‚</li>
<li>action ï¼šæ¥å—è¯·æ±‚çš„ URLï¼›ç­‰ä»·äº HTML ä¸­çš„ action ç‰¹æ€§ã€‚</li>
<li>elements ï¼šè¡¨å•ä¸­æ‰€æœ‰æ§ä»¶çš„é›†åˆï¼ˆ HTMLCollection ï¼‰ã€‚</li>
<li>enctype ï¼šè¯·æ±‚çš„ç¼–ç ç±»å‹ï¼›ç­‰ä»·äº HTML ä¸­çš„ enctype ç‰¹æ€§ã€‚</li>
<li>length ï¼šè¡¨å•ä¸­æ§ä»¶çš„æ•°é‡ã€‚</li>
<li>method ï¼šè¦å‘é€çš„ HTTP è¯·æ±‚ç±»å‹ï¼Œé€šå¸¸æ˜¯ â€œgetâ€ æˆ– â€œpostâ€ ï¼›ç­‰ä»·äº HTML çš„ method ç‰¹æ€§ã€‚</li>
<li>name ï¼šè¡¨å•çš„åç§°ï¼›ç­‰ä»·äº HTML çš„ name ç‰¹æ€§ã€‚</li>
<li>reset() ï¼šå°†æ‰€æœ‰è¡¨å•åŸŸé‡ç½®ä¸ºé»˜è®¤å€¼ã€‚</li>
<li>submit() ï¼šæäº¤è¡¨å•ã€‚</li>
<li>target ï¼šç”¨äºå‘é€è¯·æ±‚å’Œæ¥æ”¶å“åº”çš„çª—å£åç§°ï¼›ç­‰ä»·äº HTML çš„ target ç‰¹æ€§ã€‚</li>
</ul>
</blockquote>
<p>â€‹            è·å–å¾—<code>&lt;form&gt;</code> å…ƒç´ å¼•ç”¨çš„æ–¹å¼æœ€ç›´æ¥çš„æ–¹å¼å°±æ˜¯å°†å®ƒçœ‹æˆä¸å…¶ä»–å…ƒç´ ä¸€æ ·ï¼Œå¹¶ä¸ºå…¶æ·»åŠ  id ç‰¹æ€§ï¼Œç„¶åå†åƒä¸‹é¢è¿™æ ·ä½¿ç”¨ getElementById() æ–¹æ³•æ‰¾åˆ°å®ƒã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> form = <span class="built_in">document</span>.getElementById(<span class="string">"form1"</span>);</span><br></pre></td></tr></table></figure>

<p>â€‹        å…¶æ¬¡ï¼Œé€šè¿‡ document.forms å¯ä»¥å–å¾—é¡µé¢ä¸­æ‰€æœ‰çš„è¡¨å•ã€‚åœ¨è¿™ä¸ªé›†åˆä¸­ï¼Œå¯ä»¥é€šè¿‡æ•°å€¼ç´¢å¼•æˆ–name å€¼æ¥å–å¾—ç‰¹å®šçš„è¡¨å•ã€‚</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> firstForm = <span class="built_in">document</span>.forms[<span class="number">0</span>]; <span class="comment">//å–å¾—é¡µé¢ä¸­çš„ç¬¬ä¸€ä¸ªè¡¨å•</span></span><br><span class="line"><span class="keyword">var</span> myForm = <span class="built_in">document</span>.forms[<span class="string">"form2"</span>]; <span class="comment">//å–å¾—é¡µé¢ä¸­åç§°ä¸º"form2"çš„è¡¨å•</span></span><br></pre></td></tr></table></figure>

<h5 id="äºŒã€æäº¤è¡¨å•"><a href="#äºŒã€æäº¤è¡¨å•" class="headerlink" title="äºŒã€æäº¤è¡¨å•"></a>äºŒã€æäº¤è¡¨å•</h5><p>â€‹        ç”¨æˆ·å•å‡»æäº¤æŒ‰é’®æˆ–å›¾åƒæŒ‰é’®æ—¶ï¼Œå°±ä¼šæäº¤è¡¨å•ã€‚ä½¿ç”¨<code>&lt;input&gt;</code>æˆ– <code>&lt;button&gt;</code> éƒ½å¯ä»¥å®šä¹‰æäº¤æŒ‰é’®ï¼Œåªè¦å°†å…¶ type ç‰¹æ€§çš„å€¼è®¾ç½®ä¸º â€œsubmitâ€ å³å¯ï¼Œè€Œå›¾åƒæŒ‰é’®åˆ™æ˜¯é€šè¿‡å°† <code>&lt;input&gt;</code> çš„ type ç‰¹æ€§å€¼è®¾ç½®ä¸ºâ€imageâ€ æ¥å®šä¹‰çš„ã€‚å› æ­¤ï¼Œåªè¦æˆ‘ä»¬å•å‡»ä»¥ä¸‹ä»£ç ç”Ÿæˆçš„æŒ‰é’®ï¼Œå°±å¯ä»¥æäº¤è¡¨å•ã€‚</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- é€šç”¨æäº¤æŒ‰é’® --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">value</span>=<span class="string">"Submit Form"</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- è‡ªå®šä¹‰æäº¤æŒ‰é’® --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"submit"</span>&gt;</span>Submit Form<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- å›¾åƒæŒ‰é’® --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"image"</span> <span class="attr">src</span>=<span class="string">"graphic.gif"</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>â€‹        åªè¦è¡¨å•ä¸­å­˜åœ¨ä»¥ä¸Šä»»ä½•ä¸€ç§æŒ‰é’®ï¼Œé‚£ä¹ˆåœ¨ç›¸åº”çš„è¡¨å•æ§ä»¶ä¸­æ‹¥æœ‰ç„¦ç‚¹çš„æƒ…å†µä¸‹ï¼ŒæŒ‰å›è½¦å°±å¯æäº¤è¡¨å•ï¼ŒtextAreaä¾‹å¤–ã€‚</p>
<p>â€‹         ä»¥è¿™ç§æ–¹å¼æäº¤è¡¨å•æ—¶ï¼Œæµè§ˆå™¨ä¼šåœ¨å°†è¯·æ±‚å‘é€ç»™æœåŠ¡å™¨ä¹‹å‰è§¦å‘ submit äº‹ä»¶ã€‚è¿™æ ·ï¼Œæˆ‘ä»¬å°±æœ‰æœºä¼šéªŒè¯è¡¨å•æ•°æ®ï¼Œå¹¶æ®ä»¥å†³å®šæ˜¯å¦å…è®¸è¡¨å•æäº¤ã€‚é˜»æ­¢è¿™ä¸ªäº‹ä»¶çš„é»˜è®¤è¡Œä¸ºå°±å¯ä»¥å–æ¶ˆè¡¨å•æäº¤ã€‚ä»¥ä¸‹ä¸ºé˜»æ­¢è¡¨å•æäº¤æ–¹å¼ã€‚</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> form = document.getElementById(<span class="string">"myForm"</span>);</span><br><span class="line">EventUtil.addHandler(form, <span class="string">"submit"</span>, function(<span class="keyword">event</span>)&#123;</span><br><span class="line">    <span class="comment">//å–å¾—äº‹ä»¶å¯¹è±¡</span></span><br><span class="line">    <span class="keyword">event</span> = EventUtil.getEvent(<span class="keyword">event</span>);</span><br><span class="line">    <span class="comment">//é˜»æ­¢é»˜è®¤äº‹ä»¶</span></span><br><span class="line">    EventUtil.preventDefault(<span class="keyword">event</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>â€‹        åœ¨ JavaScript ä¸­ï¼Œä»¥ç¼–ç¨‹æ–¹å¼è°ƒç”¨ submit() æ–¹æ³•ä¹Ÿå¯ä»¥æäº¤è¡¨å•ã€‚è€Œä¸”ï¼Œè¿™ç§æ–¹å¼æ— éœ€è¡¨å•åŒ…å«æäº¤æŒ‰é’®ï¼Œä»»ä½•æ—¶å€™éƒ½å¯ä»¥æ­£å¸¸æäº¤è¡¨å•ã€‚</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> form = <span class="built_in">document</span>.getElementById(<span class="string">"myForm"</span>);</span><br><span class="line"><span class="comment">// æäº¤è¡¨å•</span></span><br><span class="line">form.submit();</span><br></pre></td></tr></table></figure>

<p>â€‹         ä»¥è°ƒç”¨ submit() æ–¹æ³•çš„å½¢å¼æäº¤è¡¨å•æ—¶ï¼Œä¸ä¼šè§¦å‘ submit äº‹ä»¶ï¼Œå› æ­¤è¦è®°å¾—åœ¨è°ƒç”¨æ­¤æ–¹æ³•ä¹‹å‰å…ˆéªŒè¯è¡¨å•æ•°æ®ã€‚</p>
<p>â€‹        æäº¤è¡¨å•å¯èƒ½é‡åˆ°æœ€å¤§çš„é—®é¢˜æ˜¯ï¼šé‡å¤æäº¤è¡¨å•ã€‚å½“ç¬¬ä¸€æ¬¡æäº¤è¡¨å•æ—¶ï¼Œå¦‚æœååº”æ—¶é—´å¾ˆé•¿ï¼Œç”¨æˆ·å¯èƒ½ä¼šå˜å¾—ä¸è€çƒ¦ï¼Œè€Œåå¤ç‚¹å‡»æäº¤æŒ‰é’®ï¼Œè€Œé‡å¤æäº¤è¡¨å•ã€‚</p>
<p>â€‹        è§£å†³é‡å¤æäº¤è¡¨å•çš„åŠæ³•æœ‰ä¸¤ä¸ªï¼šåœ¨ç¬¬ä¸€æ¬¡æäº¤è¡¨å•åå°±ç¦ç”¨æäº¤æŒ‰é’®ï¼Œæˆ–è€…åˆ©ç”¨ onsubmit äº‹ä»¶å¤„ç†ç¨‹åºå–æ¶ˆåç»­çš„è¡¨å•æäº¤æ“ä½œã€‚</p>
<h5 id="ä¸‰ã€é‡ç½®è¡¨å•"><a href="#ä¸‰ã€é‡ç½®è¡¨å•" class="headerlink" title="ä¸‰ã€é‡ç½®è¡¨å•"></a>ä¸‰ã€é‡ç½®è¡¨å•</h5><p>â€‹        åœ¨ç”¨æˆ·å•å‡»é‡ç½®æŒ‰é’®æ—¶ï¼Œè¡¨å•ä¼šè¢«é‡ç½®ã€‚ä½¿ç”¨ type ç‰¹æ€§å€¼ä¸º â€œresetâ€ çš„ <input> æˆ– <button> éƒ½å¯ä»¥åˆ›å»ºé‡ç½®æŒ‰é’®ï¼Œå®ä¾‹å¦‚ä¸‹ï¼š</button></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- é€šç”¨é‡ç½®æŒ‰é’® --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"reset"</span> <span class="attr">value</span>=<span class="string">"Reset Form"</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- è‡ªå®šä¹‰é‡ç½®æŒ‰é’® --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"reset"</span>&gt;</span>Reset Form<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>â€‹        åœ¨é‡ç½®è¡¨å•æ—¶ï¼Œæ‰€æœ‰è¡¨å•å­—æ®µéƒ½ä¼šæ¢å¤åˆ°é¡µé¢åˆšåŠ è½½å®Œæ¯•æ—¶çš„åˆå§‹å€¼ã€‚å¦‚æœæŸä¸ªå­—æ®µçš„åˆå§‹å€¼ä¸ºç©ºï¼Œå°±ä¼šæ¢å¤ä¸ºç©ºï¼›è€Œå¸¦æœ‰é»˜è®¤å€¼çš„å­—æ®µï¼Œä¹Ÿä¼šæ¢å¤ä¸ºé»˜è®¤å€¼ã€‚</p>
<p>â€‹         ç”¨æˆ·å•å‡»é‡ç½®æŒ‰é’®é‡ç½®è¡¨å•æ—¶ï¼Œä¼šè§¦å‘ reset äº‹ä»¶ã€‚</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> form = document.getElementById(<span class="string">"myForm"</span>);</span><br><span class="line">EventUtil.addHandler(form, <span class="string">"reset"</span>, function(<span class="keyword">event</span>)&#123;</span><br><span class="line">    <span class="comment">//å–å¾—äº‹ä»¶å¯¹è±¡</span></span><br><span class="line">    <span class="keyword">event</span> = EventUtil.getEvent(<span class="keyword">event</span>);</span><br><span class="line">    <span class="comment">//é˜»æ­¢è¡¨å•é‡ç½®</span></span><br><span class="line">    EventUtil.preventDefault(<span class="keyword">event</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>â€‹           ä¹Ÿå¯ä»¥é€šè¿‡ JavaScript æ¥é‡ç½®è¡¨å•ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> form = <span class="built_in">document</span>.getElementById(<span class="string">"myForm"</span>);</span><br><span class="line"><span class="comment">// é‡ç½®è¡¨å•</span></span><br><span class="line">form.reset();</span><br></pre></td></tr></table></figure>

<p>â€‹          è°ƒç”¨ reset() æ–¹æ³•ä¼šåƒå•å‡»é‡ç½®æŒ‰é’®ä¸€æ ·è§¦å‘ reset äº‹ä»¶ã€‚</p>
<p><strong>æç¤ºï¼š</strong>äº‹å®ä¸Šï¼Œé‡ç½®è¡¨å•çš„éœ€æ±‚æ˜¯å¾ˆå°‘è§çš„ã€‚æ›´å¸¸è§çš„åšæ³•æ˜¯æä¾›ä¸€ä¸ªå–æ¶ˆæŒ‰é’®ï¼Œè®©ç”¨æˆ·èƒ½å¤Ÿå›åˆ°å‰ä¸€ä¸ªé¡µé¢ï¼Œè€Œä¸æ˜¯ä¸åˆ†é’çº¢çš‚ç™½åœ°é‡ç½®è¡¨å•ä¸­çš„æ‰€æœ‰å€¼ã€‚</p>

      
    </div>

    
    
    
	<div>
		
	</div>
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/08/25/creat-object-JS/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/self.png">
      <meta itemprop="name" content="Anderson Wu">
      <meta itemprop="description" content="Love is love">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="é™ªä½ åº¦è¿‡æ¼«é•¿å²æœˆ">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/08/25/creat-object-JS/" class="post-title-link" itemprop="url">JSä¸­å¦‚ä½•åˆ›å»ºå¯¹è±¡</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2019-08-25 23:02:09" itemprop="dateCreated datePublished" datetime="2019-08-25T23:02:09+08:00">2019-08-25</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2020-03-28 17:03:42" itemprop="dateModified" datetime="2020-03-28T17:03:42+08:00">2020-03-28</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h4 id="JSåˆ›å»ºå¯¹è±¡æ–¹å¼"><a href="#JSåˆ›å»ºå¯¹è±¡æ–¹å¼" class="headerlink" title="JSåˆ›å»ºå¯¹è±¡æ–¹å¼"></a>JSåˆ›å»ºå¯¹è±¡æ–¹å¼</h4><h5 id="ä¸€ã€å·¥å‚æ¨¡å¼"><a href="#ä¸€ã€å·¥å‚æ¨¡å¼" class="headerlink" title="ä¸€ã€å·¥å‚æ¨¡å¼"></a>ä¸€ã€å·¥å‚æ¨¡å¼</h5><p>JSä¸­çš„å·¥å‚æ¨¡å¼ä¸Javaä¸­åˆ›å»ºå¯¹è±¡ç›¸ä¼¼ï¼Œéƒ½æ˜¯é€šè¿‡æŠ½è±¡åˆ›å»ºå¯¹è±¡çš„å…·ä½“è¿‡ç¨‹ï¼Œç”¨å‡½æ•°æ¥å°è£…ä¸€ä¸ªæ¥å£åˆ›å»ºå¯¹è±¡çš„ç»†èŠ‚ï¼Œæ¯”å¦‚ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">creationPerson</span>(<span class="params">name,age,job</span>)</span>&#123;</span><br><span class="line">	<span class="keyword">var</span> o = <span class="keyword">new</span> <span class="built_in">Object</span>();</span><br><span class="line">	o.name = name;</span><br><span class="line">	o.age = age;</span><br><span class="line">	o.job = job;</span><br><span class="line">	o.sayName = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">		alert(<span class="keyword">this</span>.name);</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="keyword">return</span> o;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> person1 = createPerson(<span class="string">"Tip"</span>, <span class="number">29</span>, <span class="string">"programer"</span>);</span><br><span class="line"><span class="keyword">var</span> person2 = createPerson(<span class="string">"Wusi"</span>, <span class="number">32</span>, <span class="string">"Doctor"</span>);</span><br></pre></td></tr></table></figure>

<p><strong>ä¼˜ç‚¹ï¼š</strong></p>
<p>â€‹          å‡½æ•°creatPerson()å¯ä»¥æ ¹æ®æ¥å—çš„å‚æ•°æ¥æ„å»ºä¸€ä¸ªåŒ…å«æ‰€æœ‰å¿…è¦ä¿¡æ¯çš„Personå¯¹è±¡ï¼Œæ¯æ¬¡è°ƒç”¨è¯¥å‡½æ•°éƒ½å¯ä»¥è¿”å›ä¸€ä¸ªåŒ…å«ä¸‰ä¸ªå±æ€§å’Œä¸€ä¸ªæ–¹æ³•çš„å¯¹è±¡ã€‚</p>
<p><strong>ç¼ºç‚¹ï¼š</strong></p>
<p>â€‹         æ²¡æœ‰è§£å†³å¯¹è±¡è¯†åˆ«çš„é—®é¢˜ï¼Œæ— æ³•ç¡®è®¤å¾—åˆ°çš„å°±æ˜¯ä¸€ä¸ªå¯¹è±¡ç±»å‹ã€‚</p>
<h5 id="äºŒã€æ„é€ å‡½æ•°æ¨¡å¼"><a href="#äºŒã€æ„é€ å‡½æ•°æ¨¡å¼" class="headerlink" title="äºŒã€æ„é€ å‡½æ•°æ¨¡å¼"></a>äºŒã€æ„é€ å‡½æ•°æ¨¡å¼</h5><p>â€‹       ä½¿ç”¨æ„å»ºå‡½æ•°åˆ›å»ºå¯¹è±¡ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">name,age,family</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.name = name;</span><br><span class="line">    <span class="keyword">this</span>.age = age;</span><br><span class="line">    <span class="keyword">this</span>.family = family;</span><br><span class="line">    <span class="keyword">this</span>.say = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        alert(<span class="keyword">this</span>.name);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> person1 = <span class="keyword">new</span> Person(<span class="string">"lisi"</span>,<span class="number">21</span>,[<span class="string">"lida"</span>,<span class="string">"lier"</span>,<span class="string">"wangwu"</span>]);</span><br><span class="line"><span class="keyword">var</span> person2 = <span class="keyword">new</span> Person(<span class="string">"lisi"</span>,<span class="number">21</span>,[<span class="string">"lida"</span>,<span class="string">"lier"</span>,<span class="string">"lisi"</span>]);</span><br><span class="line"><span class="built_in">console</span>.log(person1 <span class="keyword">instanceof</span> <span class="built_in">Object</span>); <span class="comment">//true</span></span><br><span class="line"><span class="built_in">console</span>.log(person1 <span class="keyword">instanceof</span> Person); <span class="comment">//true</span></span><br><span class="line"><span class="built_in">console</span>.log(person2 <span class="keyword">instanceof</span> <span class="built_in">Object</span>); <span class="comment">//true</span></span><br><span class="line"><span class="built_in">console</span>.log(person2 <span class="keyword">instanceof</span> Person); <span class="comment">//true</span></span><br></pre></td></tr></table></figure>

<p>â€‹        æ¯”è¾ƒæ„å»ºå‡½æ•°å’Œå·¥å‚æ¨¡å¼ï¼Œå‘ç°ä¸¤è€…ç›¸ä¼¼ï¼Œä½†åˆä¸åŒï¼Œåœ¨æ„å»ºå‡½æ•°æ¨¡å¼ä¸­ï¼š</p>
<ul>
<li>æ²¡æœ‰æ˜¾ç¤ºåœ°åˆ›å»ºå¯¹è±¡ï¼Œåªæœ‰å½“çœŸæ­£éœ€è¦å¯¹è±¡æ—¶ï¼Œæ‰åˆ›å»ºã€‚</li>
<li>ç›´æ¥å°†å±æ€§å’Œæ–¹æ³•èµ‹ç»™thiså¯¹è±¡ã€‚</li>
<li>ä¸éœ€è¦returnè¯­å¥</li>
</ul>
<p>æ„é€ å‡½æ•°å’Œæ™®é€šå‡½æ•°çš„åŒºåˆ«ï¼š</p>
<ul>
<li>æ„é€ å‡½æ•°ï¼Œæœ¬èº«å°±æ˜¯ä¸€ä¸ªå‡½æ•°</li>
<li>æ„é€ å‡½æ•°çš„å‡½æ•°åé¦–å­—æ¯å¤§å†™</li>
<li>æ„é€ å‡½æ•°å¯ä»¥åˆ›å»ºå¯¹è±¡ï¼Œè€Œä¸€èˆ¬å‡½æ•°ä¸èƒ½ã€‚</li>
</ul>
<p>åœ¨ä»¥ä¸Šä»£ç ä¸­ï¼Œè¦åˆ›å»ºpersonçš„å®ä¾‹ï¼Œå¿…é¡»ä½¿ç”¨newæ“ä½œç¬¦ï¼Œè¿™ç§æ–¹å¼è°ƒç”¨æ„é€ å‡½æ•°å®é™…ä¸Šä¼šç»å†4ä¸ªæ­¥éª¤ï¼š<br>1ã€åˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡<br>2ã€å°†æ„é€ å‡½æ•°çš„ä½œç”¨åŸŸèµ‹ç»™æ–°å¯¹è±¡ ï¼ˆthiså¯¹è±¡æŒ‡å‘è¯¥æ–°å¯¹è±¡ï¼‰<br>3ã€æ‰§è¡Œæ„é€ å‡½æ•°ä¸­çš„ä»£ç  ï¼ˆä¸ºè¯¥æ–°å¯¹è±¡æ·»åŠ å±æ€§ï¼‰<br>4ã€è¿”å›æ–°å¯¹è±¡<br>åˆ›å»ºè‡ªå®šä¹‰çš„æ„é€ å‡½æ•°å¯ä»¥å°†å®ƒçš„å®ä¾‹æ ‡è¯†ä¸ºä¸€ç§ç‰¹å®šçš„ç±»å‹ã€‚<br><strong>æ„é€ å‡½æ•°çš„ç¼ºç‚¹ï¼š</strong><br>          æ¯ä¸ªæ–¹æ³•éƒ½æœ‰åœ¨æ¯ä¸ªå®ä¾‹ä¸Šé‡æ–°åˆ›å»ºä¸€éã€‚person1å’Œperson2éƒ½æœ‰ä¸€ä¸ªsayName()çš„æ–¹æ³•ï¼Œä½†ä¸¤ä¸ªæ–¹æ³•ä¸æ˜¯åŒä¸€ä¸ªFunctionå®ä¾‹ã€‚ä¸åŒå®ä¾‹ä¸Šçš„åŒåå‡½æ•°æ˜¯ä¸ç›¸ç­‰çš„ã€‚<br>åˆ›å»ºä¸¤ä¸ªå®ŒæˆåŒæ ·ä»»åŠ¡çš„Functionå®ä¾‹æ²¡æœ‰å¿…è¦ï¼Œè€Œä¸”è¿˜æœ‰thiså¯¹è±¡åœ¨ï¼Œä¸éœ€è¦åœ¨æ‰§è¡Œä»£ç å‰å°±æŠŠå‡½æ•°ç»‘å®šåœ¨ç‰¹å®šå¯¹è±¡ä¸Šï¼Œå¯ä»¥åƒä¸‹é¢è¿™æ ·ã€‚ </p>
  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">name,age,family</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.name = name;</span><br><span class="line">    <span class="keyword">this</span>.age = age;</span><br><span class="line">    <span class="keyword">this</span>.family = family;</span><br><span class="line">    <span class="keyword">this</span>.say = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        alert(<span class="keyword">this</span>.name);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sayName</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">	<span class="built_in">console</span>.log(<span class="keyword">this</span>);</span><br><span class="line">	alert(<span class="keyword">this</span>.name);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>â€‹        æŠŠsayNameå±æ€§è®¾ç½®æˆå…¨å±€çš„sayNameå‡½æ•°ï¼Œè¿™æ ·ï¼Œç”±äºsayNameåŒ…å«çš„æ˜¯ä¸€ä¸ªæŒ‡å‘å‡½æ•°çš„æŒ‡é’ˆï¼Œå› æ­¤person1å’Œperson2å¯¹è±¡å°±å…±äº«äº†åŒä¸€ä¸ªå‡½æ•°ã€‚ </p>
<p>â€‹        è€Œè¿™ç§æƒ…å†µåˆä¼šå¼•å‘å¦ä¸€ç§æƒ…å†µï¼Œå½“å¯¹è±¡éœ€è¦å®šä¹‰å¾ˆå¤šæ–¹æ³•ï¼Œé‚£ä¹ˆå°±è¦å®šä¹‰å¾ˆå¤šå…¨å±€å‡½æ•°ï¼Œè‡ªå®šä¹‰çš„å¼•ç”¨ç±»å‹ä¹Ÿæ²¡æœ‰å°è£…å¯è¨€äº†ï¼ŒåŸå‹æ¨¡å¼å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p>
<h5 id="ä¸‰ã€åŸå‹æ¨¡å¼"><a href="#ä¸‰ã€åŸå‹æ¨¡å¼" class="headerlink" title="ä¸‰ã€åŸå‹æ¨¡å¼"></a>ä¸‰ã€åŸå‹æ¨¡å¼</h5><pre><code>åœ¨JSä¸­ï¼Œæ¯ä¸€ä¸ªå‡½æ•°éƒ½æœ‰ä¸€ä¸ªprototypeï¼ˆåŸå‹ï¼‰å±æ€§ï¼Œè¯¥å±æ€§æ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼ŒæŒ‡å‘ä¸€ä¸ªå¯¹è±¡ï¼Œåœ¨è¿™å¯¹è±¡ä¸­åŒ…å«äº†å¯ä»¥ç”±ç‰¹å®šç±»å‹çš„æ‰€æœ‰å®ä¾‹å…±äº«çš„å±æ€§å’Œæ–¹æ³•ã€‚é‚£ä¹ˆå¯ä»¥é€šè¿‡ä½¿ç”¨åŸå‹å¯¹è±¡çš„æ–¹æ³•è®©æ‰€æœ‰çš„å¯¹è±¡å®ä¾‹å…±äº«æ‰€åŒ…å«çš„å±æ€§å’Œæ–¹æ³•ï¼Œè€Œä¸ç”¨åœ¨æ„é€ æ–¹æ³•ä¸­å®šä¹‰å¯¹è±¡å®ä¾‹çš„ä¿¡æ¯ï¼Œå¯ä»¥æŠŠè¿™äº›ä¿¡æ¯ç›´æ¥æ·»åŠ åˆ°åŸå‹çš„å¯¹è±¡ä¸­ã€‚</code></pre><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">&#125;</span><br><span class="line">ã€€ã€€Person.prototype.name = <span class="string">'Nicholas'</span>;</span><br><span class="line">ã€€ã€€Person.prototype.age = <span class="number">29</span>;</span><br><span class="line">ã€€ã€€Person.prototype.job = <span class="string">'Software Engineer'</span>;</span><br><span class="line">ã€€ã€€Person.prototype.sayName = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">ã€€ã€€ã€€ã€€alert(<span class="keyword">this</span>.name);</span><br><span class="line">ã€€ã€€&#125;</span><br><span class="line">ã€€ã€€<span class="keyword">var</span> person1 = <span class="keyword">new</span> Person();</span><br><span class="line">ã€€ã€€person1.sayName();<span class="comment">//"Nicholas"</span></span><br><span class="line"></span><br><span class="line">ã€€ã€€<span class="keyword">var</span> person2 = <span class="keyword">new</span> Person(); </span><br><span class="line">ã€€ã€€person2.sayName(); <span class="comment">//"Nicholas" </span></span><br><span class="line"></span><br><span class="line">ã€€ã€€alert(person1.sayName == person2.sayName); <span class="comment">//true</span></span><br></pre></td></tr></table></figure>

<p>â€‹        åœ¨ä»¥ä¸Šä¾‹å­ä¸­ï¼ŒsayName( ) æ–¹æ³•å’Œæ‰€æœ‰çš„å±æ€§ç›´æ¥æ·»åŠ åˆ°Personç±»çš„prototypeå±æ€§ä¸­ï¼Œæ„é€ å‡½æ•°æ˜¯ä¸€ä¸ªç©ºçš„å‡½æ•°ï¼Œå¯ä»¥é€šè¿‡è°ƒç”¨æ„é€ å‡½æ•°æ¥åˆ›å»ºæ–°çš„å¯¹è±¡ï¼Œåœ¨æ–°çš„å¯¹è±¡ä¸­å…·æœ‰ç›¸åŒçš„å±æ€§å’Œæ–¹æ³•ï¼Œè¿™ä¸æ„é€ å‡½æ•°æ¨¡å¼ä¸åŒï¼Œæ–°çš„å¯¹è±¡ä¸­æ‰€æœ‰å±æ€§å’Œæ–¹æ³•éƒ½æ˜¯æ‰€æœ‰å®ä¾‹å…±äº«çš„ï¼Œå³person1å’Œperson2è®¿é—®çš„éƒ½æ˜¯åŒä¸€ç»„å±æ€§å’ŒåŒä¸€ä¸ªsayName( ) å‡½æ•°ã€‚</p>

      
    </div>

    
    
    
	<div>
		
	</div>
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/08/18/SpringBoot-Websocket/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/self.png">
      <meta itemprop="name" content="Anderson Wu">
      <meta itemprop="description" content="Love is love">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="é™ªä½ åº¦è¿‡æ¼«é•¿å²æœˆ">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/08/18/SpringBoot-Websocket/" class="post-title-link" itemprop="url">SpringBootåˆ©ç”¨websocketå®ç°å®æ—¶èŠå¤©</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2019-08-18 15:11:28" itemprop="dateCreated datePublished" datetime="2019-08-18T15:11:28+08:00">2019-08-18</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2020-03-28 17:05:12" itemprop="dateModified" datetime="2020-03-28T17:05:12+08:00">2020-03-28</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/SpringBoot/" itemprop="url" rel="index"><span itemprop="name">SpringBoot</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="ä¸€ã€ä»€ä¹ˆæ˜¯websocket-ä¸ºä»€ä¹ˆéœ€è¦å®ƒ"><a href="#ä¸€ã€ä»€ä¹ˆæ˜¯websocket-ä¸ºä»€ä¹ˆéœ€è¦å®ƒ" class="headerlink" title="ä¸€ã€ä»€ä¹ˆæ˜¯websocket?ä¸ºä»€ä¹ˆéœ€è¦å®ƒ?"></a>ä¸€ã€ä»€ä¹ˆæ˜¯websocket?ä¸ºä»€ä¹ˆéœ€è¦å®ƒ?</h3><p>â€‹         WebSocketæ˜¯ä¸€ç§è®¡ç®—æœºé€šä¿¡<strong>åè®®</strong>ï¼Œå¯ä»¥é€šè¿‡å•ä¸ªTCPè¿æ¥æä¾›<strong>å…¨åŒå·¥</strong>(å…è®¸é€šä¿¡åŒæ–¹åŒæ—¶ä¼ è¾“æ•°æ®)é€šä¿¡é€šé“ã€‚</p>
<p>é€šè¿‡HTTPä¹Ÿå¯ä»¥è¿›è¡Œå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´çš„é€šä¿¡ï¼Œä¸ºä»€ä¹ˆè¿˜éœ€è¦websocketå‘¢ï¼Ÿ</p>
<p>HTTPä¼šå…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹æˆ–ç¼ºé™·ï¼š</p>
<ul>
<li><strong>ä¼ ç»Ÿçš„HTTPè¯·æ±‚æ˜¯å•å‘çš„ -</strong> åœ¨ä¼ ç»Ÿçš„å®¢æˆ·ç«¯æœåŠ¡å™¨é€šä¿¡ä¸­ï¼Œå®¢æˆ·ç«¯å§‹ç»ˆå‘èµ·è¯·æ±‚ã€‚</li>
<li><strong>åŠåŒå·¥ -</strong> ç”¨æˆ·å¯¹èµ„æºçš„è¯·æ±‚ï¼Œç„¶åæœåŠ¡å™¨å°†å…¶æä¾›ç»™å®¢æˆ·ç«¯ã€‚å“åº”ä»…åœ¨è¯·æ±‚åå‘é€ã€‚å› æ­¤ï¼Œä¸€æ¬¡åªå‘ç”Ÿä¸€ä¸ªè¯·æ±‚ã€‚</li>
<li><strong>å¤šä¸ªTCPè¿æ¥ -</strong> å¯¹äºæ¯ä¸ªè¯·æ±‚ï¼Œéœ€è¦å»ºç«‹æ–°çš„TCPsessionï¼Œç„¶ååœ¨æ”¶åˆ°å“åº”åå…³é—­ã€‚å› æ­¤ï¼Œå¦‚æœä¸ä½¿ç”¨WebSocketsï¼Œæˆ‘ä»¬å°†æœ‰å¤šä¸ªä¼šè¯ã€‚</li>
<li><strong>é‡é‡çº§</strong> æ­£å¸¸HTTPè¯·æ±‚å’Œå“åº”éœ€è¦åœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´äº¤æ¢é¢å¤–æ•°æ®ã€‚</li>
</ul>
<p><img src="/2019/08/18/SpringBoot-Websocket/boot-32_4.jpg" alt="img"></p>
<p>â€‹        </p>
<p>â€‹         å…¶å®HTTPåè®®å…¶å®ä¹Ÿèƒ½å®ç°å•Šï¼Œæ¯”å¦‚ç”¨ Ajax è½®è¯¢æˆ–è€…Cometã€‚è½®è¯¢æ˜¯æŒ‡æµè§ˆå™¨é€šè¿‡JavaScriptå¯åŠ¨ä¸€ä¸ªå®šæ—¶å™¨ï¼Œç„¶åä»¥å›ºå®šçš„é—´éš”ç»™æœåŠ¡å™¨å‘è¯·æ±‚ï¼Œè¯¢é—®æœåŠ¡å™¨æœ‰æ²¡æœ‰æ–°æ¶ˆæ¯ã€‚è¿™ä¸ªæœºåˆ¶çš„ç¼ºç‚¹ä¸€æ˜¯å®æ—¶æ€§ä¸å¤Ÿï¼ŒäºŒæ˜¯é¢‘ç¹çš„è¯·æ±‚ä¼šç»™æœåŠ¡å™¨å¸¦æ¥æå¤§çš„å‹åŠ›ã€‚</p>
<p>Cometæœ¬è´¨ä¸Šä¹Ÿæ˜¯è½®è¯¢ï¼Œä½†æ˜¯åœ¨æ²¡æœ‰æ¶ˆæ¯çš„æƒ…å†µä¸‹ï¼ŒæœåŠ¡å™¨å…ˆæ‹–ä¸€æ®µæ—¶é—´ï¼Œç­‰åˆ°æœ‰æ¶ˆæ¯äº†å†å›å¤ã€‚è¿™ä¸ªæœºåˆ¶æš‚æ—¶åœ°è§£å†³äº†å®æ—¶æ€§é—®é¢˜ï¼Œä½†æ˜¯å®ƒå¸¦æ¥äº†æ–°çš„é—®é¢˜ï¼šä»¥å¤šçº¿ç¨‹æ¨¡å¼è¿è¡Œçš„æœåŠ¡å™¨ä¼šè®©å¤§éƒ¨åˆ†çº¿ç¨‹å¤§éƒ¨åˆ†æ—¶é—´éƒ½å¤„äºæŒ‚èµ·çŠ¶æ€ï¼Œæå¤§åœ°æµªè´¹æœåŠ¡å™¨èµ„æºã€‚å¦å¤–ï¼Œä¸€ä¸ªHTTPè¿æ¥åœ¨é•¿æ—¶é—´æ²¡æœ‰æ•°æ®ä¼ è¾“çš„æƒ…å†µä¸‹ï¼Œé“¾è·¯ä¸Šçš„ä»»ä½•ä¸€ä¸ªç½‘å…³éƒ½å¯èƒ½å…³é—­è¿™ä¸ªè¿æ¥ï¼Œè€Œç½‘å…³æ˜¯æˆ‘ä»¬ä¸å¯æ§çš„ï¼Œè¿™å°±è¦æ±‚Cometè¿æ¥å¿…é¡»å®šæœŸå‘ä¸€äº›pingæ•°æ®è¡¨ç¤ºè¿æ¥â€œæ­£å¸¸å·¥ä½œâ€ã€‚</p>
<p>ä»¥ä¸Šä¸¤ç§æœºåˆ¶éƒ½æ²»æ ‡ä¸æ²»æœ¬ï¼Œæ‰€ä»¥ï¼ŒHTML5æ¨å‡ºäº†WebSocketæ ‡å‡†ï¼Œè®©æµè§ˆå™¨å’ŒæœåŠ¡å™¨ä¹‹é—´å¯ä»¥å»ºç«‹æ— é™åˆ¶çš„å…¨åŒå·¥é€šä¿¡ï¼Œä»»ä½•ä¸€æ–¹éƒ½å¯ä»¥ä¸»åŠ¨å‘æ¶ˆæ¯ç»™å¯¹æ–¹ï¼Œä»è€Œè§£å†³äº†å®æ—¶é€šä¿¡çš„é—®é¢˜ã€‚</p>
<p><img src="/2019/08/18/SpringBoot-Websocket/ws.png" alt="img"></p>
<p>websocketå…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š</p>
<ul>
<li><strong>WebSocketæ˜¯åŒå‘çš„ -</strong>ä½¿ç”¨WebSocketå®¢æˆ·ç«¯æˆ–æœåŠ¡å™¨å¯ä»¥å‘èµ·å‘é€æ¶ˆæ¯ã€‚</li>
<li><strong>WebSocketæ˜¯å…¨åŒå·¥ -</strong>å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨é€šä¿¡å½¼æ­¤ç‹¬ç«‹ã€‚</li>
<li><strong>å•ä¸ªTCPè¿æ¥ -</strong>åˆå§‹è¿æ¥ä½¿ç”¨HTTPï¼Œç„¶åæ­¤è¿æ¥å‡çº§åˆ°åŸºäºå¥—æ¥å­—çš„è¿æ¥ã€‚ç„¶åï¼Œè¯¥å•ä¸ªè¿æ¥ç”¨äºæ‰€æœ‰æœªæ¥çš„é€šä¿¡</li>
<li><strong>è½»é‡çº§</strong>ä¸httpç›¸æ¯”ï¼ŒWebSocketæ¶ˆæ¯æ•°æ®äº¤æ¢è¦è½»å¾—å¤šã€‚</li>
</ul>
<p><img src="/2019/08/18/SpringBoot-Websocket/boot-32_5.jpg" alt="img"></p>
<p>WebSocket ä½¿å¾—å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´çš„æ•°æ®äº¤æ¢å˜å¾—æ›´åŠ ç®€å•ï¼Œå…è®¸æœåŠ¡ç«¯ä¸»åŠ¨å‘å®¢æˆ·ç«¯æ¨é€æ•°æ®ã€‚åœ¨ WebSocket API ä¸­ï¼Œæµè§ˆå™¨å’ŒæœåŠ¡å™¨åªéœ€è¦å®Œæˆä¸€æ¬¡æ¡æ‰‹ï¼Œä¸¤è€…ä¹‹é—´å°±ç›´æ¥å¯ä»¥åˆ›å»ºæŒä¹…æ€§çš„è¿æ¥ï¼Œå¹¶è¿›è¡ŒåŒå‘æ•°æ®ä¼ è¾“ã€‚</p>
<p>â€‹       ä»é€šä¿¡æ•ˆç‡æ¥çœ‹ï¼Œ WebSocket åè®®ï¼Œèƒ½æ›´å¥½çš„èŠ‚çœæœåŠ¡å™¨èµ„æºå’Œå¸¦å®½ï¼Œå¹¶ä¸”èƒ½å¤Ÿæ›´å®æ—¶åœ°è¿›è¡Œé€šè®¯ã€‚</p>
<h3 id="äºŒã€websocketåè®®ç‰¹ç‚¹"><a href="#äºŒã€websocketåè®®ç‰¹ç‚¹" class="headerlink" title="äºŒã€websocketåè®®ç‰¹ç‚¹"></a>äºŒã€websocketåè®®ç‰¹ç‚¹</h3><p>websocketåè®®åˆ©ç”¨äº†HTTPåè®®æ¥å»ºç«‹è¿æ¥ï¼Œç”±æœåŠ¡å™¨å‘èµ·è¿æ¥ï¼Œå› æ­¤websocketè¯·æ±‚æ˜¯ä¸€ä¸ªæ ‡å‡†çš„HTTPè¯·æ±‚ï¼Œæ ¼å¼å¦‚ä¸‹ï¼š</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">GET ws://localhost:3000/ws/chat HTTP/1.1</span><br><span class="line">Host: localhost</span><br><span class="line">Upgrade: websocket</span><br><span class="line">Connection: Upgrade</span><br><span class="line">Origin: http://localhost:3000</span><br><span class="line">Sec-WebSocket-Key: client-random-string</span><br><span class="line">Sec-WebSocket-Version: 13</span><br></pre></td></tr></table></figure>

<p>è¯¥è¯·æ±‚å’Œæ™®é€šçš„HTTPè¯·æ±‚æœ‰å‡ ç‚¹ä¸åŒï¼š</p>
<ol>
<li>GETè¯·æ±‚çš„åœ°å€ä¸æ˜¯ç±»ä¼¼<code>/path/</code>ï¼Œè€Œæ˜¯ä»¥<code>ws://</code>å¼€å¤´çš„åœ°å€ï¼›</li>
<li>è¯·æ±‚å¤´<code>Upgrade: websocket</code>å’Œ<code>Connection: Upgrade</code>è¡¨ç¤ºè¿™ä¸ªè¿æ¥å°†è¦è¢«è½¬æ¢ä¸ºWebSocketè¿æ¥ï¼›</li>
<li><code>Sec-WebSocket-Key</code>æ˜¯ç”¨äºæ ‡è¯†è¿™ä¸ªè¿æ¥ï¼Œå¹¶éç”¨äºåŠ å¯†æ•°æ®ï¼›</li>
<li><code>Sec-WebSocket-Version</code>æŒ‡å®šäº†WebSocketçš„åè®®ç‰ˆæœ¬ã€‚</li>
</ol>
<p>éšåï¼ŒæœåŠ¡å™¨å¦‚æœæ¥å—è¯¥è¯·æ±‚ï¼Œå°±ä¼šè¿”å›å¦‚ä¸‹å“åº”ï¼š</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">HTTP/1.1 101 Switching Protocols</span><br><span class="line">Upgrade: websocket</span><br><span class="line">Connection: Upgrade</span><br><span class="line">Sec-WebSocket-Accept: server-random-string</span><br></pre></td></tr></table></figure>

<p>è¯¥å“åº”ä»£ç <code>101</code>è¡¨ç¤ºæœ¬æ¬¡è¿æ¥çš„HTTPåè®®å³å°†è¢«æ›´æ”¹ï¼Œæ›´æ”¹åçš„åè®®å°±æ˜¯<code>Upgrade: websocket</code>æŒ‡å®šçš„WebSocketåè®®ã€‚</p>
<p>ç‰ˆæœ¬å·å’Œå­åè®®è§„å®šäº†åŒæ–¹èƒ½ç†è§£çš„æ•°æ®æ ¼å¼ï¼Œä»¥åŠæ˜¯å¦æ”¯æŒå‹ç¼©ç­‰ç­‰ã€‚å¦‚æœä»…ä½¿ç”¨WebSocketçš„APIï¼Œå°±ä¸éœ€è¦å…³å¿ƒè¿™äº›ï¼Œæ–¹æ³•å¦‚ä¸‹</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> Socket = <span class="keyword">new</span> WebSocket(url, [protocol] );</span><br></pre></td></tr></table></figure>

<p>ç°åœ¨ï¼Œä¸€ä¸ªWebSocketè¿æ¥å°±å»ºç«‹æˆåŠŸï¼Œæµè§ˆå™¨å’ŒæœåŠ¡å™¨å°±å¯ä»¥éšæ—¶ä¸»åŠ¨å‘é€æ¶ˆæ¯ç»™å¯¹æ–¹ã€‚æ¶ˆæ¯æœ‰ä¸¤ç§ï¼Œä¸€ç§æ˜¯æ–‡æœ¬ï¼Œä¸€ç§æ˜¯äºŒè¿›åˆ¶æ•°æ®ã€‚é€šå¸¸ï¼Œå¯ä»¥å‘é€JSONæ ¼å¼çš„æ–‡æœ¬ï¼Œè¿™æ ·ï¼Œåœ¨æµè§ˆå™¨å¤„ç†èµ·æ¥å°±ååˆ†å®¹æ˜“ã€‚</p>
<p>ä¸ºä»€ä¹ˆWebSocketè¿æ¥å¯ä»¥å®ç°å…¨åŒå·¥é€šä¿¡è€ŒHTTPè¿æ¥ä¸è¡Œå‘¢ï¼Ÿå®é™…ä¸ŠHTTPåè®®æ˜¯å»ºç«‹åœ¨TCPåè®®ä¹‹ä¸Šçš„ï¼ŒTCPåè®®æœ¬èº«å°±å®ç°äº†å…¨åŒå·¥é€šä¿¡ï¼Œä½†æ˜¯HTTPåè®®çš„è¯·æ±‚ï¼åº”ç­”æœºåˆ¶é™åˆ¶äº†å…¨åŒå·¥é€šä¿¡ã€‚WebSocketè¿æ¥å»ºç«‹ä»¥åï¼Œå…¶å®åªæ˜¯ç®€å•è§„å®šäº†ä¸€ä¸‹ï¼šæ¥ä¸‹æ¥ï¼Œå’±ä»¬é€šä¿¡å°±ä¸ä½¿ç”¨HTTPåè®®äº†ï¼Œç›´æ¥äº’ç›¸å‘æ•°æ®å§ã€‚</p>
<h3 id="ä¸‰ã€Websocketçš„å±æ€§ã€äº‹ä»¶å’Œæ–¹æ³•"><a href="#ä¸‰ã€Websocketçš„å±æ€§ã€äº‹ä»¶å’Œæ–¹æ³•" class="headerlink" title="ä¸‰ã€Websocketçš„å±æ€§ã€äº‹ä»¶å’Œæ–¹æ³•"></a>ä¸‰ã€Websocketçš„å±æ€§ã€äº‹ä»¶å’Œæ–¹æ³•</h3><ul>
<li>å±æ€§</li>
</ul>
<table>
<thead>
<tr>
<th align="left">å±æ€§</th>
<th align="left">æè¿°</th>
</tr>
</thead>
<tbody><tr>
<td align="left">Socket.readyState</td>
<td align="left">åªè¯»å±æ€§ <strong>readyState</strong> è¡¨ç¤ºè¿æ¥çŠ¶æ€ï¼Œå¯ä»¥æ˜¯ä»¥ä¸‹å€¼ï¼š<br>0 - è¡¨ç¤ºè¿æ¥å°šæœªå»ºç«‹ã€‚<br>1 - è¡¨ç¤ºè¿æ¥å·²å»ºç«‹ï¼Œå¯ä»¥è¿›è¡Œé€šä¿¡ã€‚<br>2 - è¡¨ç¤ºè¿æ¥æ­£åœ¨è¿›è¡Œå…³é—­ã€‚<br>3 - è¡¨ç¤ºè¿æ¥å·²ç»å…³é—­æˆ–è€…è¿æ¥ä¸èƒ½æ‰“å¼€ã€‚</td>
</tr>
<tr>
<td align="left">Socket.bufferedAmount</td>
<td align="left">åªè¯»å±æ€§ <strong>bufferedAmount</strong> å·²è¢« send() æ”¾å…¥æ­£åœ¨é˜Ÿåˆ—ä¸­ç­‰å¾…ä¼ è¾“ï¼Œä½†æ˜¯è¿˜æ²¡æœ‰å‘å‡ºçš„ UTF-8 æ–‡æœ¬å­—èŠ‚æ•°ã€‚</td>
</tr>
</tbody></table>
<ul>
<li>äº‹ä»¶</li>
</ul>
<table>
<thead>
<tr>
<th align="left">äº‹ä»¶</th>
<th align="left">äº‹ä»¶å¤„ç†ç¨‹åº</th>
<th align="left">æè¿°</th>
</tr>
</thead>
<tbody><tr>
<td align="left">open</td>
<td align="left">Socket.onopen</td>
<td align="left">è¿æ¥å»ºç«‹æ—¶è§¦å‘</td>
</tr>
<tr>
<td align="left">message</td>
<td align="left">Socket.onmessage</td>
<td align="left">å®¢æˆ·ç«¯æ¥æ”¶æœåŠ¡ç«¯æ•°æ®æ—¶è§¦å‘</td>
</tr>
<tr>
<td align="left">error</td>
<td align="left">Socket.onerror</td>
<td align="left">é€šä¿¡å‘ç”Ÿé”™è¯¯æ—¶è§¦å‘</td>
</tr>
<tr>
<td align="left">close</td>
<td align="left">Socket.onclose</td>
<td align="left">è¿æ¥å…³é—­æ—¶è§¦å‘</td>
</tr>
</tbody></table>
<ul>
<li>æ–¹æ³•</li>
</ul>
<table>
<thead>
<tr>
<th align="left">æ–¹æ³•</th>
<th align="left">æè¿°</th>
</tr>
</thead>
<tbody><tr>
<td align="left">Socket.send()</td>
<td align="left">ä½¿ç”¨è¿æ¥å‘é€æ•°æ®</td>
</tr>
<tr>
<td align="left">Socket.close()</td>
<td align="left">å…³é—­è¿æ¥</td>
</tr>
</tbody></table>
<h3 id="å››ã€SpringBoot-Websocketå®ç°èŠå¤©å®¤"><a href="#å››ã€SpringBoot-Websocketå®ç°èŠå¤©å®¤" class="headerlink" title="å››ã€SpringBoot+ Websocketå®ç°èŠå¤©å®¤"></a>å››ã€SpringBoot+ Websocketå®ç°èŠå¤©å®¤</h3><h4 id="1ã€æ­å»ºSpringBootç¯å¢ƒ"><a href="#1ã€æ­å»ºSpringBootç¯å¢ƒ" class="headerlink" title="1ã€æ­å»ºSpringBootç¯å¢ƒ"></a>1ã€æ­å»ºSpringBootç¯å¢ƒ</h4><p><strong>ï¼ˆ1ï¼‰æ–°å»ºé¡¹ç›®ï¼Œé€‰æ‹©Spring Initializrï¼Œç‚¹å‡»nextï¼š</strong></p>
<p><img src="/2019/08/18/SpringBoot-Websocket/Create2.png" alt></p>
<p><img src="/2019/08/18/SpringBoot-Websocket/create3.png" alt></p>
<p>ä¸Šé¢çš„ä¿¡æ¯å¯è‡ªè¡Œä¿®æ”¹ï¼Œå…¶ä»–é»˜è®¤å°±è¡Œï¼Œä¹‹ånextï¼š</p>
<p><strong>ï¼ˆ2ï¼‰å¦‚å›¾æ‰€ç¤ºï¼Œæ·»åŠ webä¾èµ–ï¼Œå³ä¸Šè§’Springbootç‰ˆæœ¬å·å¯è‡ªè¡Œé€‰æ‹©ã€‚ä¹‹åç‚¹å‡»nextï¼š</strong></p>
<p><img src="/2019/08/18/SpringBoot-Websocket/create4.png" alt></p>
<p><strong>ï¼ˆ4ï¼‰ç‚¹å‡»Finishå®Œæˆé¡¹ç›®åˆ›å»ºã€‚è¿›å…¥åˆ°ä¸»ç•Œé¢åï¼Œmavenä¼šä¸‹è½½ä¸€äº›ä¾èµ–åŒ…ï¼Œå¯èƒ½ä¼šéœ€è¦ä¸€æ®µæ—¶é—´ï¼Œæ•´ä½“ç›®å½•å¦‚ä¸‹ï¼š</strong></p>
<p><img src="/2019/08/18/SpringBoot-Websocket/create5.png" alt></p>
<p><img src="/2019/08/18/SpringBoot-Websocket/create6.png" alt></p>
<p><strong>ï¼ˆ5ï¼‰æµ‹è¯•</strong></p>
<p><img src="/2019/08/18/SpringBoot-Websocket/create7.png" alt></p>
<p><img src="/2019/08/18/SpringBoot-Websocket/create8.png" alt></p>
<p><strong>å¿«é€Ÿæ­å»ºSpringBooté¡¹ç›®çš„æ–¹æ³•ï¼š</strong></p>
<p>è®¿é—®å®˜ç½‘ï¼š<a href="https://start.spring.io/" target="_blank" rel="noopener">SpringBoot Initializr</a>ï¼Œå¦‚ä¸‹ï¼š</p>
<p><img src="/2019/08/18/SpringBoot-Websocket/create9.png" alt></p>
<p>è§£å‹åå¯¼å…¥IDEAï¼Œå³å¯ã€‚</p>
<h4 id="2ã€åŠŸèƒ½å®ç°"><a href="#2ã€åŠŸèƒ½å®ç°" class="headerlink" title="2ã€åŠŸèƒ½å®ç°"></a>2ã€åŠŸèƒ½å®ç°</h4><h5 id="ï¼ˆ1ï¼‰ã€å¼•å…¥ä¾èµ–"><a href="#ï¼ˆ1ï¼‰ã€å¼•å…¥ä¾èµ–" class="headerlink" title="ï¼ˆ1ï¼‰ã€å¼•å…¥ä¾èµ–"></a>ï¼ˆ1ï¼‰ã€å¼•å…¥ä¾èµ–</h5><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--websocketä¾èµ–--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-websocket<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h5 id="ï¼ˆ2ï¼‰ã€ç¼–å†™ä¸€ä¸ªWebSocketConfigé…ç½®ç±»"><a href="#ï¼ˆ2ï¼‰ã€ç¼–å†™ä¸€ä¸ªWebSocketConfigé…ç½®ç±»" class="headerlink" title="ï¼ˆ2ï¼‰ã€ç¼–å†™ä¸€ä¸ªWebSocketConfigé…ç½®ç±»"></a>ï¼ˆ2ï¼‰ã€ç¼–å†™ä¸€ä¸ªWebSocketConfigé…ç½®ç±»</h5><p><img src="/2019/08/18/SpringBoot-Websocket/Code1.png" alt></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WebSocketConfig</span> </span>&#123;</span><br><span class="line">   <span class="meta">@Bean</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> ServerEndpointExporter <span class="title">serverEndpointExporter</span><span class="params">()</span></span>&#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">new</span> ServerEndpointExporter();</span><br><span class="line">   &#125;</span><br><span class="line">   </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å‘å®¹å™¨æ³¨å…¥å¯¹è±¡ServerEndpointExporterï¼Œè¯¥beanä¼šè‡ªåŠ¨æ³¨å†Œä½¿ç”¨äº†<strong>@ServerEndpoint</strong>æ³¨è§£å£°æ˜çš„Websocket endpoint</p>
<h5 id="ï¼ˆ3ï¼‰ç¼–å†™Websocketçš„å®ç°ç±»"><a href="#ï¼ˆ3ï¼‰ç¼–å†™Websocketçš„å®ç°ç±»" class="headerlink" title="ï¼ˆ3ï¼‰ç¼–å†™Websocketçš„å®ç°ç±»"></a>ï¼ˆ3ï¼‰ç¼–å†™Websocketçš„å®ç°ç±»</h5><p><img src="/2019/08/18/SpringBoot-Websocket/Code2.png" alt></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ServerEndpoint</span>(value = <span class="string">"/websocket"</span>)</span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyWebSocket</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ç”¨æ¥å­˜æ”¾æ¯ä¸ªå®¢æˆ·ç«¯å¯¹åº”çš„MyWebSocketå¯¹è±¡ã€‚</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> CopyOnWriteArraySet&lt;MyWebSocket&gt; webSocketSet = <span class="keyword">new</span> CopyOnWriteArraySet&lt;MyWebSocket&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ä¸æŸä¸ªå®¢æˆ·ç«¯çš„è¿æ¥ä¼šè¯ï¼Œéœ€è¦é€šè¿‡å®ƒæ¥ç»™å®¢æˆ·ç«¯å‘é€æ•°æ®</span></span><br><span class="line">    <span class="keyword">private</span> Session session;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@OnOpen</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onOpen</span><span class="params">(Session session)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.session = session;</span><br><span class="line">        webSocketSet.add(<span class="keyword">this</span>);</span><br><span class="line">        System.out.println(<span class="string">"æœ‰æ–°è¿æ¥åŠ å…¥ï¼å½“å‰åœ¨çº¿äººæ•°ä¸º"</span> + webSocketSet.size());</span><br><span class="line">        <span class="keyword">this</span>.session.getAsyncRemote().sendText(<span class="string">"æ­å–œæ‚¨æˆåŠŸè¿æ¥ä¸ŠWebSocket--&gt;å½“å‰åœ¨çº¿äººæ•°ä¸ºï¼š"</span> + webSocketSet.size());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Â Â Â Â  * è¿æ¥å…³é—­è°ƒç”¨çš„æ–¹æ³•</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@OnClose</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClose</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        webSocketSet.remove(<span class="keyword">this</span>);<span class="comment">//ä»setä¸­åˆ é™¤</span></span><br><span class="line">        System.out.println(<span class="string">"æœ‰ä¸€è¿æ¥å…³é—­ï¼å½“å‰åœ¨çº¿äººæ•°ä¸º"</span> + webSocketSet.size());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Â Â Â Â  * æ”¶åˆ°å®¢æˆ·ç«¯æ¶ˆæ¯åè°ƒç”¨çš„æ–¹æ³•</span></span><br><span class="line"><span class="comment">     * Â Â Â Â  *</span></span><br><span class="line"><span class="comment">     * Â Â Â Â  * <span class="doctag">@param</span> message å®¢æˆ·ç«¯å‘é€è¿‡æ¥çš„æ¶ˆæ¯</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@OnMessage</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onMessage</span><span class="params">(String message, Session session)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"æ¥è‡ªå®¢æˆ·ç«¯çš„æ¶ˆæ¯:"</span> + message);</span><br><span class="line">        <span class="comment">//ç¾¤å‘æ¶ˆæ¯</span></span><br><span class="line">        broadcast(message);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Â å‘ç”Ÿé”™è¯¯æ—¶è°ƒç”¨</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@OnError</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onError</span><span class="params">(Session session, Throwable error)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"å‘ç”Ÿé”™è¯¯"</span>);</span><br><span class="line">        error.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     *  ç¾¤å‘è‡ªå®šä¹‰æ¶ˆæ¯Â </span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">broadcast</span><span class="params">(String message)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (MyWebSocket item : webSocketSet) &#123;</span><br><span class="line">            <span class="comment">//this.session.getBasicRemote().sendText(message);</span></span><br><span class="line">            item.session.getAsyncRemote().sendText(message);<span class="comment">//å¼‚æ­¥å‘é€æ¶ˆæ¯.</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>â€‹        webSocketSetæ˜¯ä¿å­˜ç”¨æˆ·sessionçš„é›†åˆï¼Œå½“å‡ºç°ç”¨æˆ·åŠ å…¥ç¾¤èŠæ—¶ï¼ŒæŠŠè¯¥ç”¨æˆ·çš„sessionæ·»åŠ åˆ°sessioné›†åˆä¸­ï¼Œä½†ç”¨æˆ·é€€å‡ºç¾¤èŠæ—¶ï¼Œåˆ é™¤å¯¹åº”çš„sessionã€‚</p>
<p>â€‹        å…¶ä¸­ï¼Œbroadcast()æ–¹æ³•ï¼Œå°†æ‰€æœ‰ç”¨æˆ·sessionä¸­çš„æ¶ˆæ¯ä»¥å¹¿æ’­çš„å½¢å¼å‘é€ï¼Œå‘é€çš„å½¢å¼æœ‰ï¼š</p>
<ul>
<li><p>getBasicRemote()åŒæ­¥</p>
</li>
<li><p>getAsyncRemote()å¼‚æ­¥</p>
<p>é‚£ä¸¤ç§å‘é€æ–¹å¼æœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Ÿå‚è€ƒ<a href="https://blogs.oracle.com/pavelbucek/is-websocket-session-really-thread-safe" target="_blank" rel="noopener">websocketçš„åŒæ­¥å’Œå¼‚æ­¥å‘é€åŒºåˆ«</a></p>
</li>
</ul>
<p>å¤§è‡´å¯ä»¥æ€»ç»“ä¸ºï¼š</p>
<p>â€‹        ä¸€èˆ¬æƒ…å†µï¼Œæ¨èä½¿ç”¨getAsyncRemote()ã€‚ç”±äºgetBasicRemote()çš„åŒæ­¥ç‰¹æ€§ï¼Œå¹¶ä¸”å®ƒæ”¯æŒéƒ¨åˆ†æ¶ˆæ¯çš„å‘é€å³sendText(xxx,boolean isLast)ï¼Œ isLastçš„å€¼è¡¨ç¤ºæ˜¯å¦ä¸€æ¬¡å‘é€æ¶ˆæ¯ä¸­çš„éƒ¨åˆ†æ¶ˆæ¯ï¼Œå¯¹äºå¦‚ä¸‹æƒ…å†µ:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">session.getBasicRemote().sendText(message, <span class="keyword">false</span>); </span><br><span class="line"></span><br><span class="line">session.getBasicRemote().sendBinary(data);</span><br><span class="line"></span><br><span class="line">session.getBasicRemote().sendText(message, <span class="keyword">true</span>);</span><br></pre></td></tr></table></figure>

<p>ç”±äºåŒæ­¥ç‰¹æ€§ï¼Œç¬¬äºŒè¡Œçš„æ¶ˆæ¯å¿…é¡»ç­‰å¾…ç¬¬ä¸€è¡Œçš„å‘é€å®Œæˆæ‰èƒ½è¿›è¡Œï¼Œè€Œç¬¬ä¸€è¡Œçš„å‰©ä½™éƒ¨åˆ†æ¶ˆæ¯è¦ç­‰ç¬¬äºŒè¡Œå‘é€å®Œæ‰èƒ½ç»§ç»­å‘é€ï¼Œæ‰€ä»¥åœ¨ç¬¬äºŒè¡Œä¼šæŠ›å‡ºIllegalStateExceptionå¼‚å¸¸ã€‚å¦‚æœè¦ä½¿ç”¨getBasicRemote()åŒæ­¥å‘é€æ¶ˆæ¯ï¼Œåˆ™é¿å…å°½é‡ä¸€æ¬¡å‘é€å…¨éƒ¨æ¶ˆæ¯ï¼Œä½¿ç”¨éƒ¨åˆ†æ¶ˆæ¯æ¥å‘é€ã€‚</p>
<h5 id="ï¼ˆ4ï¼‰ç¼–å†™é¡µé¢webSocketTest-html-æ”¾åˆ°staticç›®å½•ä¸‹"><a href="#ï¼ˆ4ï¼‰ç¼–å†™é¡µé¢webSocketTest-html-æ”¾åˆ°staticç›®å½•ä¸‹" class="headerlink" title="ï¼ˆ4ï¼‰ç¼–å†™é¡µé¢webSocketTest.html(æ”¾åˆ°staticç›®å½•ä¸‹)"></a>ï¼ˆ4ï¼‰ç¼–å†™é¡µé¢webSocketTest.html(æ”¾åˆ°staticç›®å½•ä¸‹)</h5><p><img src="/2019/08/18/SpringBoot-Websocket/Code3.png" alt></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">HTML</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">    Â Â Â  <span class="tag">&lt;<span class="name">title</span>&gt;</span>My WebSocket<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="css">        <span class="selector-id">#message</span> &#123;</span></span><br><span class="line">            margin-top: 40px;</span><br><span class="line">        Â Â Â Â border: 1px solid gray;</span><br><span class="line">            padding: 20px;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">onclick</span>=<span class="string">"conectWebSocket()"</span>&gt;</span>è¿æ¥WebSocket<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">onclick</span>=<span class="string">"closeWebSocket()"</span>&gt;</span>æ–­å¼€è¿æ¥<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">hr</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">æ¶ˆæ¯ï¼š<span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">"text"</span> <span class="attr">type</span>=<span class="string">"text"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">onclick</span>=<span class="string">"send()"</span>&gt;</span>å‘é€æ¶ˆæ¯<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"message"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span></span><br><span class="line"><span class="actionscript">    <span class="keyword">var</span> websocket = <span class="literal">null</span>;</span></span><br><span class="line"></span><br><span class="line"><span class="actionscript">    <span class="function"><span class="keyword">function</span> <span class="title">conectWebSocket</span><span class="params">()</span> </span>&#123;</span></span><br><span class="line"><span class="actionscript">        <span class="comment">//åˆ¤æ–­å½“å‰æµè§ˆå™¨æ˜¯å¦æ”¯æŒWebSocket</span></span></span><br><span class="line"><span class="javascript">        <span class="keyword">if</span> (<span class="string">'WebSocket'</span> <span class="keyword">in</span> <span class="built_in">window</span>) &#123;</span></span><br><span class="line"><span class="actionscript">            websocket = <span class="keyword">new</span> WebSocket(<span class="string">"ws://localhost:8080/websocket"</span>);</span></span><br><span class="line"><span class="actionscript">        &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="actionscript">            alert(<span class="string">'Not support websocket'</span>)</span></span><br><span class="line">        &#125;</span><br><span class="line"><span class="actionscript">        <span class="comment">//è¿æ¥å‘ç”Ÿé”™è¯¯çš„å›è°ƒæ–¹æ³•</span></span></span><br><span class="line"><span class="actionscript">        websocket.onerror = <span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>&#123;</span></span><br><span class="line"><span class="actionscript">            setMessageInnerHTML(<span class="string">"error"</span>);</span></span><br><span class="line">        &#125;;</span><br><span class="line"><span class="actionscript">        <span class="comment">//è¿æ¥æˆåŠŸå»ºç«‹çš„å›è°ƒæ–¹æ³•</span></span></span><br><span class="line"><span class="actionscript">        websocket.onopen = <span class="function"><span class="keyword">function</span> <span class="params">(event)</span> </span>&#123;</span></span><br><span class="line"><span class="actionscript">            setMessageInnerHTML(<span class="string">"Loc MSG: æˆåŠŸå»ºç«‹è¿æ¥"</span>);</span></span><br><span class="line">        &#125;</span><br><span class="line"><span class="actionscript">        <span class="comment">//æ¥æ”¶åˆ°æ¶ˆæ¯çš„å›è°ƒæ–¹æ³•</span></span></span><br><span class="line"><span class="actionscript">        websocket.onmessage = <span class="function"><span class="keyword">function</span> <span class="params">(event)</span> </span>&#123;</span></span><br><span class="line">            setMessageInnerHTML(event.data);</span><br><span class="line">        &#125;</span><br><span class="line"><span class="actionscript">        <span class="comment">//è¿æ¥å…³é—­çš„å›è°ƒæ–¹æ³•</span></span></span><br><span class="line"><span class="actionscript">        websocket.onclose = <span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>&#123;</span></span><br><span class="line"><span class="actionscript">            setMessageInnerHTML(<span class="string">"Loc MSG:å…³é—­è¿æ¥"</span>);</span></span><br><span class="line">        &#125;</span><br><span class="line"><span class="actionscript">        <span class="comment">//ç›‘å¬çª—å£å…³é—­äº‹ä»¶ï¼Œå½“çª—å£å…³é—­æ—¶ï¼Œä¸»åŠ¨å»å…³é—­websocketè¿æ¥ï¼Œé˜²æ­¢è¿æ¥è¿˜æ²¡æ–­å¼€å°±å…³é—­çª—å£ï¼Œserverç«¯ä¼šæŠ›å¼‚å¸¸ã€‚</span></span></span><br><span class="line"><span class="javascript">        <span class="built_in">window</span>.onbeforeunload = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span><br><span class="line">            websocket.close();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="actionscript">    <span class="comment">//å°†æ¶ˆæ¯æ˜¾ç¤ºåœ¨ç½‘é¡µä¸Š</span></span></span><br><span class="line"><span class="actionscript">    <span class="function"><span class="keyword">function</span> <span class="title">setMessageInnerHTML</span><span class="params">(innerHTML)</span> </span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="built_in">document</span>.getElementById(<span class="string">'message'</span>).innerHTML += innerHTML + <span class="string">'&lt;br/&gt;'</span>;</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="actionscript">    <span class="comment">//å…³é—­è¿æ¥</span></span></span><br><span class="line"><span class="actionscript">    <span class="function"><span class="keyword">function</span> <span class="title">closeWebSocket</span><span class="params">()</span> </span>&#123;</span></span><br><span class="line">        websocket.close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="actionscript">    <span class="comment">//å‘é€æ¶ˆæ¯</span></span></span><br><span class="line"><span class="actionscript">    <span class="function"><span class="keyword">function</span> <span class="title">send</span><span class="params">()</span> </span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> message = <span class="built_in">document</span>.getElementById(<span class="string">'text'</span>).value;</span></span><br><span class="line">        websocket.send(message);</span><br><span class="line">    &#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h5 id="ï¼ˆ5ï¼‰æµ‹è¯•"><a href="#ï¼ˆ5ï¼‰æµ‹è¯•" class="headerlink" title="ï¼ˆ5ï¼‰æµ‹è¯•"></a>ï¼ˆ5ï¼‰æµ‹è¯•</h5><p>è®¿é—®url:  localhost:8080/webSocketTest.htmlï¼Œç‚¹å‡»ã€è¿æ¥WebSocketã€‘ï¼Œå‘é€æ¶ˆæ¯ã€‚</p>
<p><img src="/2019/08/18/SpringBoot-Websocket/Test1.png" alt></p>
<p><img src="/2019/08/18/SpringBoot-Websocket/Test2.png" alt></p>
<h5 id="ï¼ˆ6ï¼‰å­˜åœ¨é—®é¢˜"><a href="#ï¼ˆ6ï¼‰å­˜åœ¨é—®é¢˜" class="headerlink" title="ï¼ˆ6ï¼‰å­˜åœ¨é—®é¢˜"></a>ï¼ˆ6ï¼‰å­˜åœ¨é—®é¢˜</h5><p>å½“å‰æ¶ˆæ¯æ— æ³•æ˜¾ç¤ºæ˜¯å“ªä½ç”¨æˆ·å‘é€çš„ï¼Œå¯é˜…è¯»æ€§å·®ï¼Œéœ€è¦æ”¹è¿›ã€‚</p>
<h4 id="3ã€æ”¹è¿›"><a href="#3ã€æ”¹è¿›" class="headerlink" title="3ã€æ”¹è¿›"></a>3ã€æ”¹è¿›</h4><p><strong>å‰ç«¯é¡µé¢çš„æ”¹è¿›</strong></p>
<h5 id="ï¼ˆ1ï¼‰è¿æ¥æ—¶ï¼Œè¾“å…¥ç”¨æˆ·æ˜µç§°"><a href="#ï¼ˆ1ï¼‰è¿æ¥æ—¶ï¼Œè¾“å…¥ç”¨æˆ·æ˜µç§°" class="headerlink" title="ï¼ˆ1ï¼‰è¿æ¥æ—¶ï¼Œè¾“å…¥ç”¨æˆ·æ˜µç§°"></a>ï¼ˆ1ï¼‰è¿æ¥æ—¶ï¼Œè¾“å…¥ç”¨æˆ·æ˜µç§°</h5><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">input type="text" id="nickname"/&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> Î¿<span class="attr">nclick</span>=<span class="string">"conectWebSocket()"</span>&gt;</span>è¿æ¥WebSocket<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h5 id="ï¼ˆ2ï¼‰è¿æ¥å‰çš„æ ¡éªŒ"><a href="#ï¼ˆ2ï¼‰è¿æ¥å‰çš„æ ¡éªŒ" class="headerlink" title="ï¼ˆ2ï¼‰è¿æ¥å‰çš„æ ¡éªŒ"></a>ï¼ˆ2ï¼‰è¿æ¥å‰çš„æ ¡éªŒ</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> nickname = <span class="built_in">document</span>.getElementById(<span class="string">"nickname"</span>).value;</span><br><span class="line"><span class="keyword">if</span>(nickname===<span class="string">""</span>)&#123;</span><br><span class="line">    alert(<span class="string">"è¯·è¾“å…¥æ˜µç§°"</span>);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="ï¼ˆ3ï¼‰æ˜¾ç¤ºæ˜µç§°"><a href="#ï¼ˆ3ï¼‰æ˜¾ç¤ºæ˜µç§°" class="headerlink" title="ï¼ˆ3ï¼‰æ˜¾ç¤ºæ˜µç§°"></a>ï¼ˆ3ï¼‰æ˜¾ç¤ºæ˜µç§°</h5><p>ä¿®æ”¹å®¢æˆ·ç«¯çš„è¿æ¥æ–¹å¼ï¼š</p>
<ul>
<li>Jsä»£ç ï¼Œä¿®æ”¹é¡µé¢webSocketTest.htmlä¸­è¿æ¥æœåŠ¡å™¨çš„URL</li>
</ul>
  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">websocket = <span class="keyword">new</span> WebSocket(<span class="string">"ws://localhost:8080/websocket/"</span>+nickname);</span><br></pre></td></tr></table></figure>

<ul>
<li>Javaä»£ç ï¼Œåœ¨MyWebSocketç±»ä¸­ï¼Œæ·»åŠ å±æ€§nicknameï¼Œä½¿å¾—æ¯ä¸ªæ–¹æ³•éƒ½å¯ä»¥è·å–è¯¥å‚æ•°ã€‚</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ServerEndpoint</span>(value = <span class="string">"/websocket/&#123;nickname&#125;"</span>)  </span><br><span class="line"><span class="meta">@Component</span>  </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyWebSocket</span> </span>&#123;&#125;</span><br></pre></td></tr></table></figure>

<p>æ·»åŠ å±æ€§ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> String nickname;</span><br></pre></td></tr></table></figure>

<p>ä¿®æ”¹å»ºç«‹è¿æ¥å’Œå‘é€æ¶ˆæ¯çš„æ–¹æ³•å‚æ•°ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@OnOpen</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onOpen</span><span class="params">(Session session,@PathParam(<span class="string">"nickname"</span>)</span> String nickname) </span>&#123;</span><br><span class="line">Â Â Â  <span class="keyword">this</span>.session = session;</span><br><span class="line">Â Â Â  <span class="keyword">this</span>.nickname=nickname;</span><br><span class="line">Â Â Â  webSocketSet.add(<span class="keyword">this</span>);Â Â Â Â  <span class="comment">//åŠ å…¥setä¸­</span></span><br><span class="line">Â Â Â  System.out.println(<span class="string">"æœ‰æ–°è¿æ¥åŠ å…¥:"</span>+nickname+<span class="string">",å½“å‰åœ¨çº¿äººæ•°ä¸º"</span> + webSocketSet.size());</span><br><span class="line">Â Â Â  <span class="keyword">this</span>.session.getAsyncRemote().sendText(<span class="string">"æ­å–œæ‚¨æˆåŠŸè¿æ¥ä¸ŠWebSocket--&gt;å½“å‰åœ¨çº¿äººæ•°ä¸ºï¼š"</span>+webSocketSet.size());</span><br><span class="line"></span><br><span class="line"><span class="meta">@OnMessage</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onMessage</span><span class="params">(String message, Session session,@PathParam(<span class="string">"nickname"</span>)</span> String nickname) </span>&#123;</span><br><span class="line">Â Â Â  System.out.println(<span class="string">"æ¥è‡ªå®¢æˆ·ç«¯çš„æ¶ˆæ¯--&gt;"</span>+nickname+<span class="string">": "</span> + message);</span><br><span class="line">Â Â Â  <span class="comment">//ç¾¤å‘æ¶ˆæ¯</span></span><br><span class="line">Â Â  Â broadcast(nickname+<span class="string">": "</span>+message);</span><br></pre></td></tr></table></figure>

<h5 id="ï¼ˆ4ï¼‰æµ‹è¯•"><a href="#ï¼ˆ4ï¼‰æµ‹è¯•" class="headerlink" title="ï¼ˆ4ï¼‰æµ‹è¯•"></a>ï¼ˆ4ï¼‰æµ‹è¯•</h5><p>è®¿é—®url:  localhost:8080/webSocketTest.htmlï¼Œç‚¹å‡»ã€è¿æ¥WebSocketã€‘ï¼Œå‘é€æ¶ˆæ¯ã€‚</p>
<p><img src="/2019/08/18/SpringBoot-Websocket/Test2-1.png" alt></p>
<p><img src="/2019/08/18/SpringBoot-Websocket/Test2-2.png" alt></p>
<h4 id="4ã€å®Œæˆï¼"><a href="#4ã€å®Œæˆï¼" class="headerlink" title="4ã€å®Œæˆï¼"></a>4ã€å®Œæˆï¼</h4><p><a href="https://github.com/AndersonBlog/SpringBootWebsocketDemo.git" target="_blank" rel="noopener">æºç åœ°å€</a></p>
<h5 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h5><p><a href="https://www.runoob.com/html/html5-websocket.html" target="_blank" rel="noopener">https://www.runoob.com/html/html5-websocket.html</a></p>
<p><a href="https://www.javainuse.com/spring/boot-websocket" target="_blank" rel="noopener">https://www.javainuse.com/spring/boot-websocket</a></p>
<p><a href="https://www.liaoxuefeng.com/wiki/1022910821149312/1103303693824096" target="_blank" rel="noopener">https://www.liaoxuefeng.com/wiki/1022910821149312/1103303693824096</a></p>

      
    </div>

    
    
    
	<div>
		
	</div>
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

  </div>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left" aria-label="ä¸Šä¸€é¡µ"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/3/"><i class="fa fa-angle-right" aria-label="ä¸‹ä¸€é¡µ"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          æ–‡ç« ç›®å½•
        </li>
        <li class="sidebar-nav-overview">
          ç«™ç‚¹æ¦‚è§ˆ
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Anderson Wu"
      src="/images/self.png">
  <p class="site-author-name" itemprop="name">Anderson Wu</p>
  <div class="site-description" itemprop="description">Love is love</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">22</span>
          <span class="site-state-item-name">æ—¥å¿—</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">5</span>
        <span class="site-state-item-name">åˆ†ç±»</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">15</span>
        <span class="site-state-item-name">æ ‡ç­¾</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/AndersonBlog" title="GitHub â†’ https:&#x2F;&#x2F;github.com&#x2F;AndersonBlog" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:anderson992@163.com" title="E-Mail â†’ mailto:anderson992@163.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i>E-Mail</a>
      </span>
  </div>
  <div class="cc-license motion-element" itemprop="license">
    <a href="https://creativecommons.org/publicdomain/zero/1.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/cc-zero.svg" alt="Creative Commons"></a>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Anderson</span>
<script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
</div>
  <div class="powered-by">ç”± <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> å¼ºåŠ›é©±åŠ¨
  </div>





        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
